"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3221],{5042:function(t,e,a){a.d(e,{C1:function(){return G},DQ:function(){return Q},I_:function(){return B},Jj:function(){return E},Lf:function(){return ek},QP:function(){return V},Yn:function(){return e$},ZH:function(){return S},aH:function(){return eW},eT:function(){return eM},gU:function(){return A},jr:function(){return K},us:function(){return W}});var r=a(48526),l=a(3485),i=a(98462),n=a(68250),s=a(3855),h=a(68227),d=a(74247),o=(0,s.eW)((t,e)=>{var a,r,l=t.x,i=t.y,n=e.x-l,s=e.y-i,h=t.width/2,d=t.height/2;return Math.abs(s)*h>Math.abs(n)*d?(s<0&&(d=-d),a=0===s?0:d*n/s,r=d):(n<0&&(h=-h),a=h,r=0===n?0:h*s/n),{x:l+a,y:i+r}},"intersectRect");function c(t,e){e&&t.attr("style",e)}async function g(t){let e=(0,h.Ys)(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),a=e.append("xhtml:div"),r=t.label;t.label&&(0,s.l0)(t.label)&&(r=await (0,s.uT)(t.label.replace(s.SY.lineBreakRegex,"\n"),(0,s.nV)()));let l=t.isNode?"nodeLabel":"edgeLabel";return a.html('<span class="'+l+'" '+(t.labelStyle?'style="'+t.labelStyle+'"':"")+">"+r+"</span>"),c(a,t.labelStyle),a.style("display","inline-block"),a.style("padding-right","1px"),a.style("white-space","nowrap"),a.attr("xmlns","http://www.w3.org/1999/xhtml"),e.node()}(0,s.eW)(c,"applyStyle"),(0,s.eW)(g,"addHtmlLabel");var y=(0,s.eW)(async(t,e,a,r)=>{let l=t||"";if("object"==typeof l&&(l=l[0]),(0,s.ku)((0,s.nV)().flowchart.htmlLabels)){l=l.replace(/\\n|\n/g,"<br />"),s.cM.info("vertexText"+l);let t={isNode:r,label:(0,n.SH)(l).replace(/fa[blrs]?:fa-[\w-]+/g,t=>`<i class='${t.replace(":"," ")}'></i>`),labelStyle:e?e.replace("fill:","color:"):e};return await g(t)}{let t=document.createElementNS("http://www.w3.org/2000/svg","text");t.setAttribute("style",e.replace("color:","fill:"));for(let e of"string"==typeof l?l.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(l)?l:[]){let r=document.createElementNS("http://www.w3.org/2000/svg","tspan");r.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),r.setAttribute("dy","1em"),r.setAttribute("x","0"),a?r.setAttribute("class","title-row"):r.setAttribute("class","row"),r.textContent=e.trim(),t.appendChild(r)}return t}},"createLabel"),p=(0,s.eW)((t,e,a,r,l)=>["M",t+l,e,"H",t+a-l,"A",l,l,0,0,1,t+a,e+l,"V",e+r-l,"A",l,l,0,0,1,t+a-l,e+r,"H",t+l,"A",l,l,0,0,1,t,e+r-l,"V",e+l,"A",l,l,0,0,1,t+l,e,"Z"].join(" "),"createRoundedRectPathD"),f=(0,s.eW)(t=>{let{handDrawnSeed:e}=(0,s.nV)();return{fill:t,hachureAngle:120,hachureGap:4,fillWeight:2,roughness:.7,stroke:t,seed:e}},"solidStateFill"),x=(0,s.eW)(t=>{let e=w([...t.cssCompiledStyles||[],...t.cssStyles||[]]);return{stylesMap:e,stylesArray:[...e]}},"compileStyles"),w=(0,s.eW)(t=>{let e=new Map;return t.forEach(t=>{let[a,r]=t.split(":");e.set(a.trim(),r?.trim())}),e},"styles2Map"),u=(0,s.eW)(t=>{let{stylesArray:e}=x(t),a=[],r=[],l=[],i=[];return e.forEach(t=>{let e=t[0];"color"===e||"font-size"===e||"font-family"===e||"font-weight"===e||"font-style"===e||"text-decoration"===e||"text-align"===e||"text-transform"===e||"line-height"===e||"letter-spacing"===e||"word-spacing"===e||"text-shadow"===e||"text-overflow"===e||"white-space"===e||"word-wrap"===e||"word-break"===e||"overflow-wrap"===e||"hyphens"===e?a.push(t.join(":")+" !important"):(r.push(t.join(":")+" !important"),e.includes("stroke")&&l.push(t.join(":")+" !important"),"fill"===e&&i.push(t.join(":")+" !important"))}),{labelStyles:a.join(";"),nodeStyles:r.join(";"),stylesArray:e,borderStyles:l,backgroundStyles:i}},"styles2String"),m=(0,s.eW)((t,e)=>{let{themeVariables:a,handDrawnSeed:r}=(0,s.nV)(),{nodeBorder:l,mainBkg:i}=a,{stylesMap:n}=x(t);return Object.assign({roughness:.7,fill:n.get("fill")||i,fillStyle:"hachure",fillWeight:4,hachureGap:5.2,stroke:n.get("stroke")||l,seed:r,strokeWidth:n.get("stroke-width")?.replace("px","")||1.3,fillLineDash:[0,0]},e)},"userNodeOverrides"),b=(0,s.eW)(async(t,e)=>{let a;s.cM.info("Creating subgraph rect for ",e.id,e);let r=(0,s.nV)(),{themeVariables:n,handDrawnSeed:c}=r,{clusterBkg:g,clusterBorder:y}=n,{labelStyles:f,nodeStyles:x,borderStyles:w,backgroundStyles:b}=u(e),k=t.insert("g").attr("class","cluster "+e.cssClasses).attr("id",e.id).attr("data-look",e.look),$=(0,s.ku)(r.flowchart.htmlLabels),M=k.insert("g").attr("class","cluster-label "),W=await (0,i.rw)(M,e.label,{style:e.labelStyle,useHtmlLabels:$,isNode:!0}),S=W.getBBox();if((0,s.ku)(r.flowchart.htmlLabels)){let t=W.children[0],e=(0,h.Ys)(W);S=t.getBoundingClientRect(),e.attr("width",S.width),e.attr("height",S.height)}let D=e.width<=S.width+e.padding?S.width+e.padding:e.width;e.width<=S.width+e.padding?e.diff=(D-e.width)/2-e.padding:e.diff=-e.padding;let v=e.height,L=e.x-D/2,C=e.y-v/2;if(s.cM.trace("Data ",e,JSON.stringify(e)),"handDrawn"===e.look){let t=d.Z.svg(k),r=m(e,{roughness:.7,fill:g,stroke:y,fillWeight:3,seed:c}),l=t.path(p(L,C,D,v,0),r);(a=k.insert(()=>(s.cM.debug("Rough node insert CXC",l),l),":first-child")).select("path:nth-child(2)").attr("style",w.join(";")),a.select("path").attr("style",b.join(";").replace("fill","stroke"))}else(a=k.insert("rect",":first-child")).attr("style",x).attr("rx",e.rx).attr("ry",e.ry).attr("x",L).attr("y",C).attr("width",D).attr("height",v);let{subGraphTitleTopMargin:P}=(0,l.L)(r);if(M.attr("transform",`translate(${e.x-S.width/2}, ${e.y-e.height/2+P})`),f){let t=M.select("span");t&&t.attr("style",f)}let A=a.node().getBBox();return e.offsetX=0,e.width=A.width,e.height=A.height,e.offsetY=S.height-e.padding/2,e.intersect=function(t){return o(e,t)},{cluster:k,labelBBox:S}},"rect"),k=(0,s.eW)((t,e)=>{let a=t.insert("g").attr("class","note-cluster").attr("id",e.id),r=a.insert("rect",":first-child"),l=0*e.padding,i=l/2;r.attr("rx",e.rx).attr("ry",e.ry).attr("x",e.x-e.width/2-i).attr("y",e.y-e.height/2-i).attr("width",e.width+l).attr("height",e.height+l).attr("fill","none");let n=r.node().getBBox();return e.width=n.width,e.height=n.height,e.intersect=function(t){return o(e,t)},{cluster:a,labelBBox:{width:0,height:0}}},"noteGroup"),$={rect:b,squareRect:b,roundedWithTitle:(0,s.eW)(async(t,e)=>{let a;let r=(0,s.nV)(),{themeVariables:l,handDrawnSeed:i}=r,{altBackground:n,compositeBackground:c,compositeTitleBackground:g,nodeBorder:f}=l,x=t.insert("g").attr("class",e.cssClasses).attr("id",e.id).attr("data-id",e.id).attr("data-look",e.look),w=x.insert("g",":first-child"),u=x.insert("g").attr("class","cluster-label"),m=x.append("rect"),b=u.node().appendChild(await y(e.label,e.labelStyle,void 0,!0)),k=b.getBBox();if((0,s.ku)(r.flowchart.htmlLabels)){let t=b.children[0],e=(0,h.Ys)(b);k=t.getBoundingClientRect(),e.attr("width",k.width),e.attr("height",k.height)}let $=0*e.padding,M=(e.width<=k.width+e.padding?k.width+e.padding:e.width)+$;e.width<=k.width+e.padding?e.diff=(M-e.width)/2-e.padding:e.diff=-e.padding;let W=e.height+$,S=e.height+$-k.height-6,D=e.x-M/2,v=e.y-W/2;e.width=M;let L=e.y-e.height/2-$/2+k.height+2;if("handDrawn"===e.look){let t=e.cssClasses.includes("statediagram-cluster-alt"),r=d.Z.svg(x),l=e.rx||e.ry?r.path(p(D,v,M,W,10),{roughness:.7,fill:g,fillStyle:"solid",stroke:f,seed:i}):r.rectangle(D,v,M,W,{seed:i});a=x.insert(()=>l,":first-child");let s=r.rectangle(D,L,M,S,{fill:t?n:c,fillStyle:t?"hachure":"solid",stroke:f,seed:i});a=x.insert(()=>l,":first-child"),m=x.insert(()=>s)}else(a=w.insert("rect",":first-child")).attr("class","outer").attr("x",D).attr("y",v).attr("width",M).attr("height",W).attr("data-look",e.look),m.attr("class","inner").attr("x",D).attr("y",L).attr("width",M).attr("height",S);u.attr("transform",`translate(${e.x-k.width/2}, ${v+1-((0,s.ku)(r.flowchart.htmlLabels)?0:3)})`);let C=a.node().getBBox();return e.height=C.height,e.offsetX=0,e.offsetY=k.height-e.padding/2,e.labelBBox=k,e.intersect=function(t){return o(e,t)},{cluster:x,labelBBox:k}},"roundedWithTitle"),noteGroup:k,divider:(0,s.eW)((t,e)=>{let a;let{themeVariables:r,handDrawnSeed:l}=(0,s.nV)(),{nodeBorder:i}=r,n=t.insert("g").attr("class",e.cssClasses).attr("id",e.id).attr("data-look",e.look),h=n.insert("g",":first-child"),c=0*e.padding,g=e.width+c;e.diff=-e.padding;let y=e.height+c,p=e.x-g/2,f=e.y-y/2;if(e.width=g,"handDrawn"===e.look){let t=d.Z.svg(n).rectangle(p,f,g,y,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:i,seed:l});a=n.insert(()=>t,":first-child")}else(a=h.insert("rect",":first-child")).attr("class","divider").attr("x",p).attr("y",f).attr("width",g).attr("height",y).attr("data-look",e.look);let x=a.node().getBBox();return e.height=x.height,e.offsetX=0,e.offsetY=0,e.intersect=function(t){return o(e,t)},{cluster:n,labelBBox:{}}},"divider")},M=new Map,W=(0,s.eW)(async(t,e)=>{let a=e.shape||"rect",r=await $[a](t,e);return M.set(e.id,r),r},"insertCluster"),S=(0,s.eW)(()=>{M=new Map},"clear"),D=(0,s.eW)((t,e,a,r,l)=>{e.arrowTypeStart&&L(t,"start",e.arrowTypeStart,a,r,l),e.arrowTypeEnd&&L(t,"end",e.arrowTypeEnd,a,r,l)},"addEdgeMarkers"),v={arrow_cross:"cross",arrow_point:"point",arrow_barb:"barb",arrow_circle:"circle",aggregation:"aggregation",extension:"extension",composition:"composition",dependency:"dependency",lollipop:"lollipop"},L=(0,s.eW)((t,e,a,r,l,i)=>{let n=v[a];if(!n){s.cM.warn(`Unknown arrow type: ${a}`);return}t.attr(`marker-${e}`,`url(${r}#${l}_${i}-${n}${"start"===e?"Start":"End"})`)},"addEdgeMarker"),C=new Map,P=new Map,A=(0,s.eW)(()=>{C.clear(),P.clear()},"clear"),Z=(0,s.eW)(t=>t?t.reduce((t,e)=>t+";"+e,""):"","getLabelStyles"),B=(0,s.eW)(async(t,e)=>{let a,r=(0,s.ku)((0,s.nV)().flowchart.htmlLabels),l=await (0,i.rw)(t,e.label,{style:Z(e.labelStyle),useHtmlLabels:r,addSvgBackground:!0,isNode:!1});s.cM.info("abc82",e,e.labelType);let n=t.insert("g").attr("class","edgeLabel"),d=n.insert("g").attr("class","label");d.node().appendChild(l);let o=l.getBBox();if(r){let t=l.children[0],e=(0,h.Ys)(l);o=t.getBoundingClientRect(),e.attr("width",o.width),e.attr("height",o.height)}if(d.attr("transform","translate("+-o.width/2+", "+-o.height/2+")"),C.set(e.id,n),e.width=o.width,e.height=o.height,e.startLabelLeft){let r=await y(e.startLabelLeft,Z(e.labelStyle)),l=t.insert("g").attr("class","edgeTerminals"),i=l.insert("g").attr("class","inner");a=i.node().appendChild(r);let n=r.getBBox();i.attr("transform","translate("+-n.width/2+", "+-n.height/2+")"),P.get(e.id)||P.set(e.id,{}),P.get(e.id).startLeft=l,R(a,e.startLabelLeft)}if(e.startLabelRight){let r=await y(e.startLabelRight,Z(e.labelStyle)),l=t.insert("g").attr("class","edgeTerminals"),i=l.insert("g").attr("class","inner");a=l.node().appendChild(r),i.node().appendChild(r);let n=r.getBBox();i.attr("transform","translate("+-n.width/2+", "+-n.height/2+")"),P.get(e.id)||P.set(e.id,{}),P.get(e.id).startRight=l,R(a,e.startLabelRight)}if(e.endLabelLeft){let r=await y(e.endLabelLeft,Z(e.labelStyle)),l=t.insert("g").attr("class","edgeTerminals"),i=l.insert("g").attr("class","inner");a=i.node().appendChild(r);let n=r.getBBox();i.attr("transform","translate("+-n.width/2+", "+-n.height/2+")"),l.node().appendChild(r),P.get(e.id)||P.set(e.id,{}),P.get(e.id).endLeft=l,R(a,e.endLabelLeft)}if(e.endLabelRight){let r=await y(e.endLabelRight,Z(e.labelStyle)),l=t.insert("g").attr("class","edgeTerminals"),i=l.insert("g").attr("class","inner");a=i.node().appendChild(r);let n=r.getBBox();i.attr("transform","translate("+-n.width/2+", "+-n.height/2+")"),l.node().appendChild(r),P.get(e.id)||P.set(e.id,{}),P.get(e.id).endRight=l,R(a,e.endLabelRight)}return l},"insertEdgeLabel");function R(t,e){(0,s.nV)().flowchart.htmlLabels&&t&&(t.style.width=9*e.length+"px",t.style.height="12px")}(0,s.eW)(R,"setTerminalWidth");var E=(0,s.eW)((t,e)=>{s.cM.debug("Moving label abc88 ",t.id,t.label,C.get(t.id),e);let a=e.updatedPath?e.updatedPath:e.originalPath,r=(0,s.nV)(),{subGraphTitleTotalMargin:i}=(0,l.L)(r);if(t.label){let r=C.get(t.id),l=t.x,h=t.y;if(a){let r=n.w8.calcLabelPosition(a);s.cM.debug("Moving label "+t.label+" from (",l,",",h,") to (",r.x,",",r.y,") abc88"),e.updatedPath&&(l=r.x,h=r.y)}r.attr("transform",`translate(${l}, ${h+i/2})`)}if(t.startLabelLeft){let e=P.get(t.id).startLeft,r=t.x,l=t.y;if(a){let e=n.w8.calcTerminalLabelPosition(t.arrowTypeStart?10:0,"start_left",a);r=e.x,l=e.y}e.attr("transform",`translate(${r}, ${l})`)}if(t.startLabelRight){let e=P.get(t.id).startRight,r=t.x,l=t.y;if(a){let e=n.w8.calcTerminalLabelPosition(t.arrowTypeStart?10:0,"start_right",a);r=e.x,l=e.y}e.attr("transform",`translate(${r}, ${l})`)}if(t.endLabelLeft){let e=P.get(t.id).endLeft,r=t.x,l=t.y;if(a){let e=n.w8.calcTerminalLabelPosition(t.arrowTypeEnd?10:0,"end_left",a);r=e.x,l=e.y}e.attr("transform",`translate(${r}, ${l})`)}if(t.endLabelRight){let e=P.get(t.id).endRight,r=t.x,l=t.y;if(a){let e=n.w8.calcTerminalLabelPosition(t.arrowTypeEnd?10:0,"end_right",a);r=e.x,l=e.y}e.attr("transform",`translate(${r}, ${l})`)}},"positionEdgeLabel"),T=(0,s.eW)((t,e)=>{let a=t.x,r=t.y,l=Math.abs(e.x-a),i=Math.abs(e.y-r),n=t.width/2,s=t.height/2;return l>=n||i>=s},"outsideNode"),I=(0,s.eW)((t,e,a)=>{s.cM.debug(`intersection calc abc89:
  outsidePoint: ${JSON.stringify(e)}
  insidePoint : ${JSON.stringify(a)}
  node        : x:${t.x} y:${t.y} w:${t.width} h:${t.height}`);let r=t.x,l=t.y,i=Math.abs(r-a.x),n=t.width/2,h=a.x<e.x?n-i:n+i,d=t.height/2,o=Math.abs(e.y-a.y),c=Math.abs(e.x-a.x);if(Math.abs(l-e.y)*n>Math.abs(r-e.x)*d){let t=a.y<e.y?e.y-d-l:l-d-e.y;h=c*t/o;let r={x:a.x<e.x?a.x+h:a.x-c+h,y:a.y<e.y?a.y+o-t:a.y-o+t};return 0===h&&(r.x=e.x,r.y=e.y),0===c&&(r.x=e.x),0===o&&(r.y=e.y),s.cM.debug(`abc89 top/bottom calc, Q ${o}, q ${t}, R ${c}, r ${h}`,r),r}{let t=o*(h=a.x<e.x?e.x-n-r:r-n-e.x)/c,l=a.x<e.x?a.x+c-h:a.x-c+h,i=a.y<e.y?a.y+t:a.y-t;return s.cM.debug(`sides calc abc89, Q ${o}, q ${t}, R ${c}, r ${h}`,{_x:l,_y:i}),0===h&&(l=e.x,i=e.y),0===c&&(l=e.x),0===o&&(i=e.y),{x:l,y:i}}},"intersection"),_=(0,s.eW)((t,e)=>{s.cM.warn("abc88 cutPathAtIntersect",t,e);let a=[],r=t[0],l=!1;return t.forEach(t=>{if(s.cM.info("abc88 checking point",t,e),T(e,t)||l)s.cM.warn("abc88 outside",t,r),r=t,l||a.push(t);else{let i=I(e,r,t);s.cM.debug("abc88 inside",t,r,i),s.cM.debug("abc88 intersection",i,e);let n=!1;a.forEach(t=>{n=n||t.x===i.x&&t.y===i.y}),a.some(t=>t.x===i.x&&t.y===i.y)?s.cM.warn("abc88 no intersect",i,a):a.push(i),l=!0}}),s.cM.debug("returning points",a),a},"cutPathAtIntersect");function Y(t){let e=[],a=[];for(let r=1;r<t.length-1;r++){let l=t[r-1],i=t[r],n=t[r+1];l.x===i.x&&i.y===n.y&&Math.abs(i.x-n.x)>5&&Math.abs(i.y-l.y)>5?(e.push(i),a.push(r)):l.y===i.y&&i.x===n.x&&Math.abs(i.x-l.x)>5&&Math.abs(i.y-n.y)>5&&(e.push(i),a.push(r))}return{cornerPoints:e,cornerPointPositions:a}}(0,s.eW)(Y,"extractCornerPoints");var H=(0,s.eW)(function(t,e,a){let r=e.x-t.x,l=e.y-t.y,i=a/Math.sqrt(r*r+l*l);return{x:e.x-i*r,y:e.y-i*l}},"findAdjacentPoint"),N=(0,s.eW)(function(t){let{cornerPointPositions:e}=Y(t),a=[];for(let r=0;r<t.length;r++)if(e.includes(r)){let e=t[r-1],l=t[r+1],i=t[r],n=H(e,i,5),h=H(l,i,5),d=h.x-n.x,o=h.y-n.y;a.push(n);let c=2*Math.sqrt(2),g={x:i.x,y:i.y};Math.abs(l.x-e.x)>10&&Math.abs(l.y-e.y)>=10?(s.cM.debug("Corner point fixing",Math.abs(l.x-e.x),Math.abs(l.y-e.y)),g=i.x===n.x?{x:d<0?n.x-5+c:n.x+5-c,y:o<0?n.y-c:n.y+c}:{x:d<0?n.x-c:n.x+c,y:o<0?n.y-5+c:n.y+5-c}):s.cM.debug("Corner point skipping fixing",Math.abs(l.x-e.x),Math.abs(l.y-e.y)),a.push(g,h)}else a.push(t[r]);return a},"fixCorners"),V=(0,s.eW)(function(t,e,a,r,i,n,o){let c,g;let{handDrawnSeed:y}=(0,s.nV)(),p=e.points,f=!1;n.intersect&&i.intersect&&((p=p.slice(1,e.points.length-1)).unshift(i.intersect(p[0])),s.cM.debug("Last point APA12",e.start,"-->",e.end,p[p.length-1],n,n.intersect(p[p.length-1])),p.push(n.intersect(p[p.length-1]))),e.toCluster&&(s.cM.info("to cluster abc88",a.get(e.toCluster)),p=_(e.points,a.get(e.toCluster).node),f=!0),e.fromCluster&&(s.cM.debug("from cluster abc88",a.get(e.fromCluster),JSON.stringify(p,null,2)),p=_(p.reverse(),a.get(e.fromCluster).node).reverse(),f=!0);let x=p.filter(t=>!Number.isNaN(t.y)),w=(x=N(x))[x.length-1];if(x.length>1){w=x[x.length-1];let t=x[x.length-2],e=(w.x-t.x)/2,a=(w.y-t.y)/2,r={x:t.x+e,y:t.y+a};x.splice(-1,0,r)}let u=h.$0Z;e.curve&&(u=e.curve);let{x:m,y:b}=(0,l.o)(e),k=(0,h.jvg)().x(m).y(b).curve(u);switch(e.thickness){case"normal":default:c="edge-thickness-normal";break;case"thick":c="edge-thickness-thick";break;case"invisible":c="edge-thickness-invisible"}switch(e.pattern){case"solid":default:c+=" edge-pattern-solid";break;case"dotted":c+=" edge-pattern-dotted";break;case"dashed":c+=" edge-pattern-dashed"}let $=k(x),M=Array.isArray(e.style)?e.style:[e.style];if("handDrawn"===e.look){let a=d.Z.svg(t);Object.assign([],x);let r=a.path($,{roughness:.3,seed:y});c+=" transition";let l=(g=(0,h.Ys)(r).select("path").attr("id",e.id).attr("class"," "+c+(e.classes?" "+e.classes:"")).attr("style",M?M.reduce((t,e)=>t+";"+e,""):"")).attr("d");g.attr("d",l),t.node().appendChild(g.node())}else g=t.append("path").attr("d",$).attr("id",e.id).attr("class"," "+c+(e.classes?" "+e.classes:"")).attr("style",M?M.reduce((t,e)=>t+";"+e,""):"");let W="";((0,s.nV)().flowchart.arrowMarkerAbsolute||(0,s.nV)().state.arrowMarkerAbsolute)&&(W=(W=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search).replace(/\(/g,"\\(").replace(/\)/g,"\\)")),s.cM.info("arrowTypeStart",e.arrowTypeStart),s.cM.info("arrowTypeEnd",e.arrowTypeEnd),D(g,e,W,o,r);let S={};return f&&(S.updatedPath=p),S.originalPath=e.points,S},"insertEdge"),X=(0,s.eW)((t,e,a,r)=>{e.forEach(e=>{F[e](t,a,r)})},"insertMarkers"),q=(0,s.eW)((t,e,a)=>{s.cM.trace("Making markers for ",a),t.append("defs").append("marker").attr("id",a+"_"+e+"-extensionStart").attr("class","marker extension "+e).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 1,7 L18,13 V 1 Z"),t.append("defs").append("marker").attr("id",a+"_"+e+"-extensionEnd").attr("class","marker extension "+e).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 1,1 V 13 L18,7 Z")},"extension"),j=(0,s.eW)((t,e,a)=>{t.append("defs").append("marker").attr("id",a+"_"+e+"-compositionStart").attr("class","marker composition "+e).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),t.append("defs").append("marker").attr("id",a+"_"+e+"-compositionEnd").attr("class","marker composition "+e).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"composition"),O=(0,s.eW)((t,e,a)=>{t.append("defs").append("marker").attr("id",a+"_"+e+"-aggregationStart").attr("class","marker aggregation "+e).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),t.append("defs").append("marker").attr("id",a+"_"+e+"-aggregationEnd").attr("class","marker aggregation "+e).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"aggregation"),U=(0,s.eW)((t,e,a)=>{t.append("defs").append("marker").attr("id",a+"_"+e+"-dependencyStart").attr("class","marker dependency "+e).attr("refX",6).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 5,7 L9,13 L1,7 L9,1 Z"),t.append("defs").append("marker").attr("id",a+"_"+e+"-dependencyEnd").attr("class","marker dependency "+e).attr("refX",13).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L14,7 L9,1 Z")},"dependency"),z=(0,s.eW)((t,e,a)=>{t.append("defs").append("marker").attr("id",a+"_"+e+"-lollipopStart").attr("class","marker lollipop "+e).attr("refX",13).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6),t.append("defs").append("marker").attr("id",a+"_"+e+"-lollipopEnd").attr("class","marker lollipop "+e).attr("refX",1).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6)},"lollipop"),J=(0,s.eW)((t,e,a)=>{t.append("marker").attr("id",a+"_"+e+"-pointEnd").attr("class","marker "+e).attr("viewBox","0 0 10 10").attr("refX",5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),t.append("marker").attr("id",a+"_"+e+"-pointStart").attr("class","marker "+e).attr("viewBox","0 0 10 10").attr("refX",4.5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 5 L 10 10 L 10 0 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"point"),F={extension:q,composition:j,aggregation:O,dependency:U,lollipop:z,point:J,circle:(0,s.eW)((t,e,a)=>{t.append("marker").attr("id",a+"_"+e+"-circleEnd").attr("class","marker "+e).attr("viewBox","0 0 10 10").attr("refX",11).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),t.append("marker").attr("id",a+"_"+e+"-circleStart").attr("class","marker "+e).attr("viewBox","0 0 10 10").attr("refX",-1).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"circle"),cross:(0,s.eW)((t,e,a)=>{t.append("marker").attr("id",a+"_"+e+"-crossEnd").attr("class","marker cross "+e).attr("viewBox","0 0 11 11").attr("refX",12).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0"),t.append("marker").attr("id",a+"_"+e+"-crossStart").attr("class","marker cross "+e).attr("viewBox","0 0 11 11").attr("refX",-1).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0")},"cross"),barb:(0,s.eW)((t,e,a)=>{t.append("defs").append("marker").attr("id",a+"_"+e+"-barbEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",14).attr("markerUnits","userSpaceOnUse").attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z")},"barb")},Q=X,G=(0,s.eW)(async(t,e,a)=>{let r,l,d;let o=e.useHtmlLabels||(0,s.ku)((0,s.nV)().flowchart.htmlLabels);r=a||"node default";let c=t.insert("g").attr("class",r).attr("id",e.domId||e.id),g=c.insert("g").attr("class","label").attr("style",e.labelStyle);l=void 0===e.label?"":"string"==typeof e.label?e.label:e.label[0];let y=(d=await (0,i.rw)(g,(0,s.oO)((0,n.SH)(l),(0,s.nV)()),{useHtmlLabels:o,width:e.width||(0,s.nV)().flowchart.wrappingWidth,cssClasses:"markdown-node-label",style:e.labelStyle,addSvgBackground:!!e.icon||!!e.img})).getBBox(),p=e.padding/2;if((0,s.ku)((0,s.nV)().flowchart.htmlLabels)){let t=d.children[0],e=(0,h.Ys)(d),a=t.getElementsByTagName("img");if(a){let t=""===l.replace(/<img[^>]*>/g,"").trim();await Promise.all([...a].map(e=>new Promise(a=>{function r(){if(e.style.display="flex",e.style.flexDirection="column",t){let t=5*parseInt((0,s.nV)().fontSize?(0,s.nV)().fontSize:window.getComputedStyle(document.body).fontSize,10)+"px";e.style.minWidth=t,e.style.maxWidth=t}else e.style.width="100%";a(e)}(0,s.eW)(r,"setupImage"),setTimeout(()=>{e.complete&&r()}),e.addEventListener("error",r),e.addEventListener("load",r)})))}y=t.getBoundingClientRect(),e.attr("width",y.width),e.attr("height",y.height)}return o?g.attr("transform","translate("+-y.width/2+", "+-y.height/2+")"):g.attr("transform","translate(0, "+-y.height/2+")"),e.centerLabel&&g.attr("transform","translate("+-y.width/2+", "+-y.height/2+")"),g.insert("rect",":first-child"),{shapeSvg:c,bbox:y,halfPadding:p,label:g}},"labelHelper"),K=(0,s.eW)((t,e)=>{let a=e.node().getBBox();t.width=a.width,t.height=a.height},"updateNodeBounds"),tt=(0,s.eW)((t,e)=>("handDrawn"===t.look?"rough-node":"node")+" "+t.cssClasses+" "+(e||""),"getNodeClasses");function te(t){let e=t.map((t,e)=>`${0===e?"M":"L"}${t.x},${t.y}`);return e.push("Z"),e.join(" ")}function ta(t,e,a,r,l,i){let n=[],s=a-t,h=2*Math.PI/(s/i),d=e+(r-e)/2;for(let e=0;e<=50;e++){let a=t+e/50*s,r=d+l*Math.sin(h*(a-t));n.push({x:a,y:r})}return n}function tr(t,e,a,r,l,i){let n=[],s=l*Math.PI/180,h=(i*Math.PI/180-s)/(r-1);for(let l=0;l<r;l++){let r=s+l*h,i=t+a*Math.cos(r),d=e+a*Math.sin(r);n.push({x:-i,y:-d})}return n}function tl(t,e,a,r){var l=t.x,i=t.y,n=l-r.x,s=i-r.y,h=Math.sqrt(e*e*s*s+a*a*n*n),d=Math.abs(e*a*n/h);r.x<l&&(d=-d);var o=Math.abs(e*a*s/h);return r.y<i&&(o=-o),{x:l+d,y:i+o}}function ti(t,e,a){return tl(t,e,e,a)}function tn(t,e,a,r){var l,i,n,s,h,d,o,c,g,y,p,f,x;if(l=e.y-t.y,n=t.x-e.x,h=e.x*t.y-t.x*e.y,g=l*a.x+n*a.y+h,y=l*r.x+n*r.y+h,!(0!==g&&0!==y&&ts(g,y))&&(i=r.y-a.y,s=a.x-r.x,d=r.x*a.y-a.x*r.y,o=i*t.x+s*t.y+d,c=i*e.x+s*e.y+d,!(0!==o&&0!==c&&ts(o,c))&&0!=(p=l*s-i*n)))return f=Math.abs(p/2),{x:(x=n*d-s*h)<0?(x-f)/p:(x+f)/p,y:(x=i*h-l*d)<0?(x-f)/p:(x+f)/p}}function ts(t,e){return t*e>0}function th(t,e,a){let r=t.x,l=t.y,i=[],n=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY;"function"==typeof e.forEach?e.forEach(function(t){n=Math.min(n,t.x),s=Math.min(s,t.y)}):(n=Math.min(n,e.x),s=Math.min(s,e.y));let h=r-t.width/2-n,d=l-t.height/2-s;for(let r=0;r<e.length;r++){let l=e[r],n=e[r<e.length-1?r+1:0],s=tn(t,a,{x:h+l.x,y:d+l.y},{x:h+n.x,y:d+n.y});s&&i.push(s)}return i.length?(i.length>1&&i.sort(function(t,e){let r=t.x-a.x,l=t.y-a.y,i=Math.sqrt(r*r+l*l),n=e.x-a.x,s=e.y-a.y,h=Math.sqrt(n*n+s*s);return i<h?-1:i===h?0:1}),i[0]):t}(0,s.eW)(te,"createPathFromPoints"),(0,s.eW)(ta,"generateFullSineWavePoints"),(0,s.eW)(tr,"generateCirclePoints"),(0,s.eW)(function(t,e){return t.intersect(e)},"intersectNode"),(0,s.eW)(tl,"intersectEllipse"),(0,s.eW)(ti,"intersectCircle"),(0,s.eW)(tn,"intersectLine"),(0,s.eW)(ts,"sameSign"),(0,s.eW)(th,"intersectPolygon");var td={circle:ti,polygon:th,rect:o},to=(0,s.eW)(async(t,e,a)=>{let r;let{labelStyles:l,nodeStyles:i}=u(e);e.labelStyle=l;let{shapeSvg:n,bbox:s}=await G(t,e,tt(e)),h=Math.max(s.width+2*a.labelPaddingX,e?.width||0),o=Math.max(s.height+2*a.labelPaddingY,e?.height||0),c=-h/2,g=-o/2,{rx:y,ry:f}=e,{cssStyles:x}=e;if(a?.rx&&a.ry&&(y=a.rx,f=a.ry),"handDrawn"===e.look){let t=d.Z.svg(n),a=m(e,{}),l=y||f?t.path(p(c,g,h,o,y||0),a):t.rectangle(c,g,h,o,a);(r=n.insert(()=>l,":first-child")).attr("class","basic label-container").attr("style",x)}else(r=n.insert("rect",":first-child")).attr("class","basic label-container").attr("style",i).attr("rx",y).attr("ry",f).attr("x",c).attr("y",g).attr("width",h).attr("height",o);return K(e,r),e.intersect=function(t){return td.rect(e,t)},n},"drawRect"),tc=(0,s.eW)(async(t,e)=>to(t,e,{rx:5,ry:5,classes:"flowchart-node"}),"state"),tg=(0,s.eW)(async(t,e)=>{let a={rx:5,ry:5,classes:"",labelPaddingX:1*(e?.padding||0),labelPaddingY:1*(e?.padding||0)};return to(t,e,a)},"roundedRect"),ty=(0,s.eW)(async(t,e)=>{let a={rx:0,ry:0,classes:"",labelPaddingX:2*(e?.padding||0),labelPaddingY:1*(e?.padding||0)};return to(t,e,a)},"squareRect"),tp=(0,s.eW)((t,e,{config:{themeVariables:a}})=>{let r;let{lineColor:l}=a,i=t.insert("g").attr("class","node default").attr("id",e.domId||e.id);if("handDrawn"===e.look){let t=d.Z.svg(i).circle(0,0,14,f(l));r=i.insert(()=>t)}else r=i.insert("circle",":first-child");return r.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14),K(e,r),e.intersect=function(t){return td.circle(e,7,t)},i},"stateStart"),tf=(0,s.eW)((t,e,{config:{themeVariables:a}})=>{let{labelStyles:r,nodeStyles:l}=u(e);e.labelStyle=r;let{cssStyles:i}=e,{lineColor:n,stateBorder:s,nodeBorder:h}=a,o=t.insert("g").attr("class","node default").attr("id",e.domId||e.id),c=d.Z.svg(o),g=m(e,{});"handDrawn"!==e.look&&(g.roughness=0,g.fillStyle="solid");let y=c.circle(0,0,14,{...g,stroke:n,strokeWidth:2}),p=s??h,f=c.circle(0,0,5,{...g,fill:p,stroke:p,strokeWidth:2,fillStyle:"solid"}),x=o.insert(()=>y,":first-child");return x.insert(()=>f),i&&x.selectAll("path").attr("style",i),l&&x.selectAll("path").attr("style",l),K(e,x),e.intersect=function(t){return td.circle(e,7,t)},o},"stateEnd"),tx=(0,s.eW)((t,e,{dir:a,config:{state:r,themeVariables:l}})=>{let{nodeStyles:i}=u(e);e.label="";let n=t.insert("g").attr("class",tt(e)).attr("id",e.domId??e.id),{cssStyles:s}=e,h=Math.max(70,e?.width??0),o=Math.max(10,e?.height??0);"LR"===a&&(h=Math.max(10,e?.width??0),o=Math.max(70,e?.height??0));let c=-1*h/2,g=-1*o/2,y=d.Z.svg(n),p=m(e,{stroke:l.lineColor,fill:l.lineColor});"handDrawn"!==e.look&&(p.roughness=0,p.fillStyle="solid");let f=y.rectangle(c,g,h,o,p),x=n.insert(()=>f,":first-child");s&&"handDrawn"!==e.look&&x.selectAll("path").attr("style",s),i&&"handDrawn"!==e.look&&x.selectAll("path").attr("style",i),K(e,x);let w=r?.padding??0;return e.width&&e.height&&(e.width+=w/2||0,e.height+=w/2||0),e.intersect=function(t){return td.rect(e,t)},n},"forkJoin"),tw=(0,s.eW)((t,e)=>{let{nodeStyles:a}=u(e);e.label="";let r=t.insert("g").attr("class",tt(e)).attr("id",e.domId??e.id),{cssStyles:l}=e,i=Math.max(28,e.width??0),n=[{x:0,y:i/2},{x:i/2,y:0},{x:0,y:-i/2},{x:-i/2,y:0}],s=d.Z.svg(r),h=m(e,{});"handDrawn"!==e.look&&(h.roughness=0,h.fillStyle="solid");let o=te(n),c=s.path(o,h),g=r.insert(()=>c,":first-child");return l&&"handDrawn"!==e.look&&g.selectAll("path").attr("style",l),a&&"handDrawn"!==e.look&&g.selectAll("path").attr("style",a),e.width=28,e.height=28,e.intersect=function(t){return td.polygon(e,n,t)},r},"choice"),tu=(0,s.eW)(async(t,e,{config:{themeVariables:a}})=>{let{labelStyles:r,nodeStyles:l}=u(e);e.labelStyle=r;let{shapeSvg:i,bbox:n}=await G(t,e,tt(e)),s=Math.max(n.width+(e.padding??0)*2,e?.width??0),h=Math.max(n.height+(e.padding??0)*2,e?.height??0),{cssStyles:o}=e;e.useHtmlLabels||(e.centerLabel=!0);let c=d.Z.svg(i),g=m(e,{fill:a.noteBkgColor,stroke:a.noteBorderColor});"handDrawn"!==e.look&&(g.roughness=0,g.fillStyle="solid");let y=c.rectangle(-s/2,-h/2,s,h,g),p=i.insert(()=>y,":first-child");return p.attr("class","basic label-container"),o&&"handDrawn"!==e.look&&p.selectAll("path").attr("style",o),l&&"handDrawn"!==e.look&&p.selectAll("path").attr("style",l),K(e,p),e.intersect=function(t){return td.rect(e,t)},i},"note"),tm=(0,s.eW)(async(t,e)=>{let a;let{labelStyles:r,nodeStyles:l}=u(e);e.labelStyle=r;let{shapeSvg:i,bbox:n}=await G(t,e,tt(e)),s=n.height+e.padding,h=n.width+s/4+e.padding,{cssStyles:o}=e;if("handDrawn"===e.look){let t=d.Z.svg(i),r=m(e,{}),l=p(-h/2,-s/2,h,s,s/2),n=t.path(l,r);(a=i.insert(()=>n,":first-child")).attr("class","basic label-container").attr("style",o)}else(a=i.insert("rect",":first-child")).attr("class","basic label-container").attr("style",l).attr("rx",s/2).attr("ry",s/2).attr("x",-h/2).attr("y",-s/2).attr("width",h).attr("height",s);return K(e,a),e.intersect=function(t){return td.rect(e,t)},i},"stadium"),tb=(0,s.eW)(async(t,e)=>{let a,r,l;let{labelStyles:i,nodeStyles:n}=u(e);e.labelStyle=i,a=e.cssClasses?"node "+e.cssClasses:"node default";let o=t.insert("g").attr("class",a).attr("id",e.domId||e.id),c=o.insert("g"),g=o.insert("g").attr("class","label").attr("style",n),f=e.description,x=e.label,w=g.node().appendChild(await y(x,e.labelStyle,!0,!0)),b={width:0,height:0};if((0,s.ku)(s.nV()?.flowchart?.htmlLabels)){let t=w.children[0],e=(0,h.Ys)(w);b=t.getBoundingClientRect(),e.attr("width",b.width),e.attr("height",b.height)}s.cM.info("Text 2",f);let k=f||[],$=w.getBBox(),M=g.node().appendChild(await y(k.join?k.join("<br/>"):k,e.labelStyle,!0,!0)),W=M.children[0],S=(0,h.Ys)(M);b=W.getBoundingClientRect(),S.attr("width",b.width),S.attr("height",b.height);let D=(e.padding||0)/2;(0,h.Ys)(M).attr("transform","translate( "+(b.width>$.width?0:($.width-b.width)/2)+", "+($.height+D+5)+")"),(0,h.Ys)(w).attr("transform","translate( "+(b.width<$.width?0:-($.width-b.width)/2)+", 0)"),b=g.node().getBBox(),g.attr("transform","translate("+-b.width/2+", "+(-b.height/2-D+3)+")");let v=b.width+(e.padding||0),L=b.height+(e.padding||0),C=-b.width/2-D,P=-b.height/2-D;if("handDrawn"===e.look){let t=d.Z.svg(o),a=m(e,{}),i=t.path(p(C,P,v,L,e.rx||0),a),n=t.line(-b.width/2-D,-b.height/2-D+$.height+D,b.width/2+D,-b.height/2-D+$.height+D,a);l=o.insert(()=>(s.cM.debug("Rough node insert CXC",i),n),":first-child"),r=o.insert(()=>(s.cM.debug("Rough node insert CXC",i),i),":first-child")}else r=c.insert("rect",":first-child"),l=c.insert("line"),r.attr("class","outer title-state").attr("style",n).attr("x",-b.width/2-D).attr("y",-b.height/2-D).attr("width",b.width+(e.padding||0)).attr("height",b.height+(e.padding||0)),l.attr("class","divider").attr("x1",-b.width/2-D).attr("x2",b.width/2+D).attr("y1",-b.height/2-D+$.height+D).attr("y2",-b.height/2-D+$.height+D);return K(e,r),e.intersect=function(t){return td.rect(e,t)},o},"rectWithTitle");function tk(t,e,a,r){return t.insert("polygon",":first-child").attr("points",r.map(function(t){return t.x+","+t.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-e/2+","+a/2+")")}(0,s.eW)(tk,"insertPolygonShape");var t$=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i}=await G(t,e,tt(e)),n=(e?.padding||0)/2,s=i.width+e.padding,h=i.height+e.padding,o=-i.width/2-n,c=-i.height/2-n,g=[{x:0,y:0},{x:s,y:0},{x:s,y:-h},{x:0,y:-h},{x:0,y:0},{x:-8,y:0},{x:s+8,y:0},{x:s+8,y:-h},{x:-8,y:-h},{x:-8,y:0}];if("handDrawn"===e.look){let t=d.Z.svg(l),a=m(e,{}),r=t.rectangle(o-8,c,s+16,h,a),i=t.line(o,c,o,c+h,a),n=t.line(o+s,c,o+s,c+h,a);l.insert(()=>i,":first-child"),l.insert(()=>n,":first-child");let g=l.insert(()=>r,":first-child"),{cssStyles:y}=e;g.attr("class","basic label-container").attr("style",y),K(e,g)}else{let t=tk(l,s,h,g);r&&t.attr("style",r),K(e,t)}return e.intersect=function(t){return td.polygon(e,g,t)},l},"subroutine"),tM=(0,s.eW)((t,e,a,r,l,i)=>`M${t},${e+i} a${l},${i} 0,0,0 ${a},0 a${l},${i} 0,0,0 ${-a},0 l0,${r} a${l},${i} 0,0,0 ${a},0 l0,${-r}`,"createCylinderPathD"),tW=(0,s.eW)((t,e,a,r,l,i)=>`M${t},${e+i} M${t+a},${e+i} a${l},${i} 0,0,0 ${-a},0 l0,${r} a${l},${i} 0,0,0 ${a},0 l0,${-r}`,"createOuterCylinderPathD"),tS=(0,s.eW)((t,e,a,r,l,i)=>`M${t-a/2},${-r/2} a${l},${i} 0,0,0 ${a},0`,"createInnerCylinderPathD"),tD=(0,s.eW)(async(t,e)=>{let a;let{labelStyles:r,nodeStyles:l}=u(e);e.labelStyle=r;let{shapeSvg:i,bbox:n,label:s}=await G(t,e,tt(e)),h=Math.max(n.width+e.padding,e.width??0),o=h/2,c=o/(2.5+h/50),g=Math.max(n.height+c+e.padding,e.height??0),{cssStyles:y}=e;if("handDrawn"===e.look){let t=d.Z.svg(i),r=tW(0,0,h,g,o,c),l=tS(0,c,h,g,o,c),n=t.path(r,m(e,{})),s=t.path(l,m(e,{fill:"none"}));a=i.insert(()=>s,":first-child"),(a=i.insert(()=>n,":first-child")).attr("class","basic label-container"),y&&a.attr("style",y)}else{let t=tM(0,0,h,g,o,c);a=i.insert("path",":first-child").attr("d",t).attr("class","basic label-container").attr("style",y).attr("style",l)}return a.attr("label-offset-y",c),a.attr("transform",`translate(${-h/2}, ${-(g/2+c)})`),K(e,a),s.attr("transform",`translate(${-(n.width/2)-(n.x-(n.left??0))}, ${-(n.height/2)+(e.padding??0)/1.5-(n.y-(n.top??0))})`),e.intersect=function(t){let a=td.rect(e,t),r=a.x-(e.x??0);if(0!=o&&(Math.abs(r)<(e.width??0)/2||Math.abs(r)==(e.width??0)/2&&Math.abs(a.y-(e.y??0))>(e.height??0)/2-c)){let l=c*c*(1-r*r/(o*o));l>0&&(l=Math.sqrt(l)),l=c-l,t.y-(e.y??0)>0&&(l=-l),a.y+=l}return a},i},"cylinder"),tv=(0,s.eW)(async(t,e)=>{let a;let{labelStyles:r,nodeStyles:l}=u(e);e.labelStyle=r;let{shapeSvg:i,bbox:n,halfPadding:h}=await G(t,e,tt(e)),o=n.width/2+h,{cssStyles:c}=e;if("handDrawn"===e.look){let t=d.Z.svg(i),r=m(e,{}),l=t.circle(0,0,2*o,r);(a=i.insert(()=>l,":first-child")).attr("class","basic label-container").attr("style",c)}else a=i.insert("circle",":first-child").attr("class","basic label-container").attr("style",l).attr("r",o).attr("cx",0).attr("cy",0);return K(e,a),e.intersect=function(t){return s.cM.info("Circle intersect",e,o,t),td.circle(e,o,t)},i},"circle"),tL=(0,s.eW)(async(t,e)=>{let a;let{labelStyles:r,nodeStyles:l}=u(e);e.labelStyle=r;let{shapeSvg:i,bbox:n,halfPadding:h}=await G(t,e,tt(e)),o=n.width/2+h+5,c=n.width/2+h,{cssStyles:g}=e;if("handDrawn"===e.look){let t=d.Z.svg(i),r=m(e,{roughness:.2,strokeWidth:2.5}),l=m(e,{roughness:.2,strokeWidth:1.5}),n=t.circle(0,0,2*o,r),s=t.circle(0,0,2*c,l);(a=i.insert("g",":first-child")).attr("class",e.cssClasses).attr("style",g),a.node()?.appendChild(n),a.node()?.appendChild(s)}else{let t=(a=i.insert("g",":first-child")).insert("circle",":first-child"),e=a.insert("circle");a.attr("class","basic label-container").attr("style",l),t.attr("class","outer-circle").attr("style",l).attr("r",o).attr("cx",0).attr("cy",0),e.attr("class","inner-circle").attr("style",l).attr("r",c).attr("cx",0).attr("cy",0)}return K(e,a),e.intersect=function(t){return s.cM.info("DoubleCircle intersect",e,o,t),td.circle(e,o,t)},i},"doublecircle"),tC=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i,label:n}=await G(t,e,tt(e)),s=Math.max(i.width+(e.padding??0),e?.width??0),h=Math.max(i.height+(e.padding??0),e?.height??0),o=-s/2,c=-h/2,g=c/2,y=[{x:o+g,y:c},{x:o,y:0},{x:o+g,y:-c},{x:-o,y:-c},{x:-o,y:c}],{cssStyles:p}=e,f=d.Z.svg(l),x=m(e,{});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");let w=te(y),b=f.path(w,x),k=l.insert(()=>b,":first-child");return k.attr("class","basic label-container"),p&&"handDrawn"!==e.look&&k.selectAll("path").attr("style",p),r&&"handDrawn"!==e.look&&k.selectAll("path").attr("style",r),k.attr("transform",`translate(${-g/2},0)`),n.attr("transform",`translate(${-g/2-i.width/2-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),K(e,k),e.intersect=function(t){return td.polygon(e,y,t)},l},"rect_left_inv_arrow"),tP=(0,s.eW)((t,e,a)=>`M${t+a/2},${e} L${t+a},${e-a/2} L${t+a/2},${e-a} L${t},${e-a/2} Z`,"createDecisionBoxPathD"),tA=(0,s.eW)(async(t,e)=>{let a;let{labelStyles:r,nodeStyles:l}=u(e);e.labelStyle=r;let{shapeSvg:i,bbox:n}=await G(t,e,tt(e)),h=n.width+e.padding+(n.height+e.padding),o=[{x:h/2,y:0},{x:h,y:-h/2},{x:h/2,y:-h},{x:0,y:-h/2}],{cssStyles:c}=e;if("handDrawn"===e.look){let t=d.Z.svg(i),r=m(e,{}),l=tP(0,0,h),n=t.path(l,r);a=i.insert(()=>n,":first-child").attr("transform",`translate(${-h/2}, ${h/2})`),c&&a.attr("style",c)}else a=tk(i,h,h,o);return l&&a.attr("style",l),K(e,a),e.intersect=function(t){return s.cM.debug("APA12 Intersect called SPLIT\npoint:",t,"\nnode:\n",e,"\nres:",td.polygon(e,o,t)),td.polygon(e,o,t)},i},"question"),tZ=(0,s.eW)((t,e,a,r,l)=>`M${t+l},${e} L${t+a-l},${e} L${t+a},${e-r/2} L${t+a-l},${e-r} L${t+l},${e-r} L${t},${e-r/2} Z`,"createHexagonPathD"),tB=(0,s.eW)(async(t,e)=>{let a;let{labelStyles:r,nodeStyles:l}=u(e);e.labelStyle=r;let{shapeSvg:i,bbox:n}=await G(t,e,tt(e)),s=n.height+e.padding,h=s/4,o=n.width+2*h+e.padding,c=[{x:h,y:0},{x:o-h,y:0},{x:o,y:-s/2},{x:o-h,y:-s},{x:h,y:-s},{x:0,y:-s/2}],{cssStyles:g}=e;if("handDrawn"===e.look){let t=d.Z.svg(i),r=m(e,{}),l=tZ(0,0,o,s,h),n=t.path(l,r);a=i.insert(()=>n,":first-child").attr("transform",`translate(${-o/2}, ${s/2})`),g&&a.attr("style",g)}else a=tk(i,o,s,c);return l&&a.attr("style",l),e.width=o,e.height=s,K(e,a),e.intersect=function(t){return td.polygon(e,c,t)},i},"hexagon");async function tR(t,e){let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i}=await G(t,e,tt(e)),n=Math.max(i.width+e.padding,e?.width||0),s=Math.max(i.height+e.padding,e?.height||0),h=l.insert("rect",":first-child");return h.attr("class","text").attr("style",r).attr("rx",0).attr("ry",0).attr("x",-n/2).attr("y",-s/2).attr("width",n).attr("height",s),K(e,h),e.intersect=function(t){return td.rect(e,t)},l}async function tE(t,e){let a;let{labelStyles:r,nodeStyles:l}=u(e);e.labelStyle=r;let{shapeSvg:i,bbox:n}=await G(t,e,tt(e)),s=n.height+e.padding,h=n.width+e.padding+12,o=-s,c=[{x:12,y:o},{x:h,y:o},{x:h,y:0},{x:0,y:0},{x:0,y:o+12},{x:12,y:o}],{cssStyles:g}=e;if("handDrawn"===e.look){let t=d.Z.svg(i),r=m(e,{}),l=te(c),n=t.path(l,r);a=i.insert(()=>n,":first-child").attr("transform",`translate(${-h/2}, ${s/2})`),g&&a.attr("style",g)}else a=tk(i,h,s,c);return l&&a.attr("style",l),K(e,a),e.intersect=function(t){return td.polygon(e,c,t)},i}(0,s.eW)(tR,"text"),(0,s.eW)(tE,"card");var tT=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i,label:n}=await G(t,e,tt(e)),s=e?.padding??0,h=Math.max(i.width+(e.padding??0)*2,e?.width??0),o=Math.max(i.height+(e.padding??0)*2,e?.height??0),c=-i.width/2-s,g=-i.height/2-s,{cssStyles:y}=e,p=d.Z.svg(l),f=m(e,{});"handDrawn"!==e.look&&(f.roughness=0,f.fillStyle="solid");let x=p.polygon([{x:c,y:g},{x:c+h+8,y:g},{x:c+h+8,y:g+o},{x:c-8,y:g+o},{x:c-8,y:g},{x:c,y:g},{x:c,y:g+o}].map(t=>[t.x,t.y]),f),w=l.insert(()=>x,":first-child");return w.attr("class","basic label-container").attr("style",y),r&&"handDrawn"!==e.look&&w.selectAll("path").attr("style",r),y&&"handDrawn"!==e.look&&w.selectAll("path").attr("style",r),n.attr("transform",`translate(${-h/2+4+(e.padding??0)-(i.x-(i.left??0))},${-o/2+(e.padding??0)-(i.y-(i.top??0))})`),K(e,w),e.intersect=function(t){return td.rect(e,t)},l},"shadedProcess"),tI=(0,s.eW)((t,e)=>{let{labelStyles:a}=u(e);e.labelStyle=a;let r=tt(e),l=r;r||(l="anchor");let i=t.insert("g").attr("class",l).attr("id",e.domId||e.id),{cssStyles:n}=e,h=d.Z.svg(i),o=m(e,{fill:"black",stroke:"none",fillStyle:"solid"});"handDrawn"!==e.look&&(o.roughness=0);let c=h.circle(0,0,2,o),g=i.insert(()=>c,":first-child");return g.attr("class","anchor").attr("style",n),K(e,g),e.intersect=function(t){return s.cM.info("Circle intersect",e,1,t),td.circle(e,1,t)},i},"anchor"),t_=(0,s.eW)(async(t,e)=>{let a;let{labelStyles:r,nodeStyles:l}=u(e);e.labelStyle=r;let{shapeSvg:i,bbox:n}=await G(t,e,tt(e)),s=Math.max(n.width+(e.padding??0),e?.width??0),h=Math.max(n.height+(e.padding??0),e?.height??0),o=[{x:-3*h/6,y:0},{x:s,y:0},{x:s+3*h/6,y:-h},{x:0,y:-h}],{cssStyles:c}=e;if("handDrawn"===e.look){let t=d.Z.svg(i),r=m(e,{}),l=te(o),n=t.path(l,r);a=i.insert(()=>n,":first-child").attr("transform",`translate(${-s/2}, ${h/2})`),c&&a.attr("style",c)}else a=tk(i,s,h,o);return l&&a.attr("style",l),e.width=s,e.height=h,K(e,a),e.intersect=function(t){return td.polygon(e,o,t)},i},"lean_right"),tY=(0,s.eW)(async(t,e)=>{let a;let{labelStyles:r,nodeStyles:l}=u(e);e.labelStyle=r;let{shapeSvg:i,bbox:n}=await G(t,e,tt(e)),s=Math.max(n.width+(e.padding??0),e?.width??0),h=Math.max(n.height+(e.padding??0),e?.height??0),o=[{x:0,y:0},{x:s+3*h/6,y:0},{x:s,y:-h},{x:-(3*h)/6,y:-h}],{cssStyles:c}=e;if("handDrawn"===e.look){let t=d.Z.svg(i),r=m(e,{}),l=te(o),n=t.path(l,r);a=i.insert(()=>n,":first-child").attr("transform",`translate(${-s/2}, ${h/2})`),c&&a.attr("style",c)}else a=tk(i,s,h,o);return l&&a.attr("style",l),e.width=s,e.height=h,K(e,a),e.intersect=function(t){return td.polygon(e,o,t)},i},"lean_left"),tH=(0,s.eW)(async(t,e)=>{let a;let{labelStyles:r,nodeStyles:l}=u(e);e.labelStyle=r;let{shapeSvg:i,bbox:n}=await G(t,e,tt(e)),s=n.width+e.padding,h=n.height+e.padding,o=[{x:-3*h/6,y:0},{x:s+3*h/6,y:0},{x:s,y:-h},{x:0,y:-h}],{cssStyles:c}=e;if("handDrawn"===e.look){let t=d.Z.svg(i),r=m(e,{}),l=te(o),n=t.path(l,r);a=i.insert(()=>n,":first-child").attr("transform",`translate(${-s/2}, ${h/2})`),c&&a.attr("style",c)}else a=tk(i,s,h,o);return l&&a.attr("style",l),e.width=s,e.height=h,K(e,a),e.intersect=function(t){return td.polygon(e,o,t)},i},"trapezoid"),tN=(0,s.eW)(async(t,e)=>{let a;let{labelStyles:r,nodeStyles:l}=u(e);e.labelStyle=r;let{shapeSvg:i,bbox:n}=await G(t,e,tt(e)),s=Math.max(n.width+(e.padding??0)*2,e?.width??0),h=Math.max(n.height+(e.padding??0)*2,e?.height??0),o=[{x:0,y:0},{x:s,y:0},{x:s+3*h/6,y:-h},{x:-3*h/6,y:-h}],{cssStyles:c}=e;if("handDrawn"===e.look){let t=d.Z.svg(i),r=m(e,{}),l=te(o),n=t.path(l,r);a=i.insert(()=>n,":first-child").attr("transform",`translate(${-s/2}, ${h/2})`),c&&a.attr("style",c)}else a=tk(i,s,h,o);return l&&a.attr("style",l),e.width=s,e.height=h,K(e,a),e.intersect=function(t){return td.polygon(e,o,t)},i},"inv_trapezoid"),tV=(0,s.eW)(async(t,e)=>{let{shapeSvg:a,bbox:r,label:l}=await G(t,e,"label"),i=a.insert("rect",":first-child");return i.attr("width",.1).attr("height",.1),a.attr("class","label edgeLabel"),l.attr("transform",`translate(${-(r.width/2)-(r.x-(r.left??0))}, ${-(r.height/2)-(r.y-(r.top??0))})`),K(e,i),e.intersect=function(t){return td.rect(e,t)},a},"labelRect"),tX=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i,label:n}=await G(t,e,tt(e)),h=(0,s.ku)(s.nV().flowchart?.htmlLabels),o=i.width+(e.padding??0),c=o+i.height,g=o+i.height,y=[{x:0,y:0},{x:g,y:0},{x:g/2,y:-c}],{cssStyles:p}=e,f=d.Z.svg(l),x=m(e,{});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");let w=te(y),b=f.path(w,x),k=l.insert(()=>b,":first-child").attr("transform",`translate(${-c/2}, ${c/2})`);return p&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",p),r&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",r),e.width=o,e.height=c,K(e,k),n.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${c/2-(i.height+(e.padding??0)/(h?2:1)-(i.y-(i.top??0)))})`),e.intersect=function(t){return s.cM.info("Triangle intersect",e,y,t),td.polygon(e,y,t)},l},"triangle"),tq=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i}=await G(t,e,tt(e)),n=Math.max(80,i.width+(e.padding??0)*2,e?.width??0),h=Math.max(50,i.height+(e.padding??0)*2,e?.height??0),o=h/2,{cssStyles:c}=e,g=d.Z.svg(l),y=m(e,{});"handDrawn"!==e.look&&(y.roughness=0,y.fillStyle="solid");let p=[{x:-n/2,y:-h/2},{x:n/2-o,y:-h/2},...tr(-n/2+o,0,o,50,90,270),{x:n/2-o,y:h/2},{x:-n/2,y:h/2}],f=te(p),x=g.path(f,y),w=l.insert(()=>x,":first-child");return w.attr("class","basic label-container"),c&&"handDrawn"!==e.look&&w.selectChildren("path").attr("style",c),r&&"handDrawn"!==e.look&&w.selectChildren("path").attr("style",r),K(e,w),e.intersect=function(t){return s.cM.info("Pill intersect",e,{radius:o,point:t}),td.polygon(e,p,t)},l},"halfRoundedRectangle"),tj=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i}=await G(t,e,tt(e)),n=Math.max(80,(i.width+(e.padding??0)*2)*1.25,e?.width??0),s=Math.max(20,i.height+(e.padding??0)*2,e?.height??0),h=s/2,{cssStyles:o}=e,c=d.Z.svg(l),g=m(e,{});"handDrawn"!==e.look&&(g.roughness=0,g.fillStyle="solid");let y=n-h,p=s/4,f=[{x:y,y:0},{x:p,y:0},{x:0,y:s/2},{x:p,y:s},{x:y,y:s},...tr(-y,-s/2,h,50,270,90)],x=te(f),w=c.path(x,g),b=l.insert(()=>w,":first-child");return b.attr("class","basic label-container"),o&&"handDrawn"!==e.look&&b.selectChildren("path").attr("style",o),r&&"handDrawn"!==e.look&&b.selectChildren("path").attr("style",r),b.attr("transform",`translate(${-n/2}, ${-s/2})`),K(e,b),e.intersect=function(t){return td.polygon(e,f,t)},l},"curvedTrapezoid"),tO=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i,label:n}=await G(t,e,tt(e)),s=Math.max(i.width+(e.padding??0)*2,e?.width??0),h=Math.max(i.height+(e.padding??0)*2,e?.height??0),o=-s/2,c=-h/2,{cssStyles:g}=e,y=d.Z.svg(l),p=m(e,{});"handDrawn"!==e.look&&(p.roughness=0,p.fillStyle="solid");let f=[{x:o,y:c},{x:o,y:c+h},{x:o+s,y:c+h},{x:o+s,y:c-h/2}],x=te(f),w=y.path(x,p),b=l.insert(()=>w,":first-child");return b.attr("class","basic label-container"),g&&"handDrawn"!==e.look&&b.selectChildren("path").attr("style",g),r&&"handDrawn"!==e.look&&b.selectChildren("path").attr("style",r),b.attr("transform",`translate(0, ${h/4})`),n.attr("transform",`translate(${-s/2+(e.padding??0)-(i.x-(i.left??0))}, ${-h/4+(e.padding??0)-(i.y-(i.top??0))})`),K(e,b),e.intersect=function(t){return td.polygon(e,f,t)},l},"slopedRect");function tU(t,e,a,r,l,i,n){let s=Math.atan2(r-e,a-t),h=Math.sqrt(((a-t)/2/l)**2+((r-e)/2/i)**2);if(h>1)throw Error("The given radii are too small to create an arc between the points.");let d=Math.sqrt(1-h**2),o=(t+a)/2+d*i*Math.sin(s)*(n?-1:1),c=(e+r)/2-d*l*Math.cos(s)*(n?-1:1),g=Math.atan2((e-c)/i,(t-o)/l),y=Math.atan2((r-c)/i,(a-o)/l)-g;n&&y<0&&(y+=2*Math.PI),!n&&y>0&&(y-=2*Math.PI);let p=[];for(let t=0;t<20;t++){let e=g+t/19*y,a=o+l*Math.cos(e),r=c+i*Math.sin(e);p.push({x:a,y:r})}return p}(0,s.eW)(tU,"generateArcPoints");var tz=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i}=await G(t,e,tt(e)),n=i.width+e.padding+20,s=i.height+e.padding,h=s/2,o=h/(2.5+s/50),{cssStyles:c}=e,g=[{x:n/2,y:-s/2},{x:-n/2,y:-s/2},...tU(-n/2,-s/2,-n/2,s/2,o,h,!1),{x:n/2,y:s/2},...tU(n/2,s/2,n/2,-s/2,o,h,!0)],y=d.Z.svg(l),p=m(e,{});"handDrawn"!==e.look&&(p.roughness=0,p.fillStyle="solid");let f=te(g),x=y.path(f,p),w=l.insert(()=>x,":first-child");return w.attr("class","basic label-container"),c&&"handDrawn"!==e.look&&w.selectAll("path").attr("style",c),r&&"handDrawn"!==e.look&&w.selectAll("path").attr("style",r),w.attr("transform",`translate(${o/2}, 0)`),K(e,w),e.intersect=function(t){return td.polygon(e,g,t)},l},"bowTieRect"),tJ=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i,label:n}=await G(t,e,tt(e)),s=i.width+e.padding,h=i.height+e.padding,o=.2*h,c=-s/2,g=-h/2-o/2,{cssStyles:y}=e,p=d.Z.svg(l),f=m(e,{});"handDrawn"!==e.look&&(f.roughness=0,f.fillStyle="solid");let x=p.polygon([{x:c,y:g+o},{x:-c,y:g+o},{x:-c,y:-g},{x:c,y:-g},{x:c,y:g},{x:-c,y:g},{x:-c,y:g+o}].map(t=>[t.x,t.y]),f),w=l.insert(()=>x,":first-child");return w.attr("class","basic label-container"),y&&"handDrawn"!==e.look&&w.selectAll("path").attr("style",y),r&&"handDrawn"!==e.look&&w.selectAll("path").attr("style",r),n.attr("transform",`translate(${c+(e.padding??0)/2-(i.x-(i.left??0))}, ${g+o+(e.padding??0)/2-(i.y-(i.top??0))})`),K(e,w),e.intersect=function(t){return td.rect(e,t)},l},"dividedRectangle");function tF(t){let e=Math.cos(Math.PI/4),a=Math.sin(Math.PI/4),r=2*t,l={x:r/2*e,y:r/2*a},i={x:-(r/2)*e,y:r/2*a},n={x:-(r/2)*e,y:-(r/2)*a},s={x:r/2*e,y:-(r/2)*a};return`M ${i.x},${i.y} L ${s.x},${s.y}
                   M ${l.x},${l.y} L ${n.x},${n.y}`}(0,s.eW)(tF,"createLine");var tQ=(0,s.eW)((t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a,e.label="";let l=t.insert("g").attr("class",tt(e)).attr("id",e.domId??e.id),i=Math.max(30,e?.width??0),{cssStyles:n}=e,h=d.Z.svg(l),o=m(e,{});"handDrawn"!==e.look&&(o.roughness=0,o.fillStyle="solid");let c=h.circle(0,0,2*i,o),g=tF(i),y=h.path(g,o),p=l.insert(()=>c,":first-child");return p.insert(()=>y),n&&"handDrawn"!==e.look&&p.selectAll("path").attr("style",n),r&&"handDrawn"!==e.look&&p.selectAll("path").attr("style",r),K(e,p),e.intersect=function(t){return s.cM.info("crossedCircle intersect",e,{radius:i,point:t}),td.circle(e,i,t)},l},"crossedCircle"),tG=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i}=await G(t,e,tt(e)),n=Math.max(i.width+(e.padding??0)*2,e?.width??0),s=Math.max(i.height+(e.padding??0)*2,e?.height??0),h=n/s,o=n,c=s;o>c*h?c=o/h:o=c*h,o=Math.max(o,100);let g=Math.min(.2*(c=Math.max(c,50)),c/4),y=c+2*g,{cssStyles:p}=e,f=d.Z.svg(l),x=m(e,{});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");let w=[{x:-o/2,y:y/2},...ta(-o/2,y/2,o/2,y/2,g,1),{x:o/2,y:-y/2},...ta(o/2,-y/2,-o/2,-y/2,g,-1)],b=te(w),k=f.path(b,x),$=l.insert(()=>k,":first-child");return $.attr("class","basic label-container"),p&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",p),r&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",r),K(e,$),e.intersect=function(t){return td.polygon(e,w,t)},l},"waveRectangle"),tK=(0,s.eW)((t,e,a,r,l,i)=>`M${t},${e}
    a${l},${i} 0,0,1 0,${-r}
    l${a},0
    a${l},${i} 0,0,1 0,${r}
    M${a},${-r}
    a${l},${i} 0,0,0 0,${r}
    l${-a},0`,"createCylinderPathD"),t0=(0,s.eW)((t,e,a,r,l,i)=>`M${t},${e} M${t+a},${e} a${l},${i} 0,0,0 0,${-r} l${-a},0 a${l},${i} 0,0,0 0,${r} l${a},0`,"createOuterCylinderPathD"),t2=(0,s.eW)((t,e,a,r,l,i)=>`M${t+a/2},${-r/2} a${l},${i} 0,0,0 0,${r}`,"createInnerCylinderPathD"),t1=(0,s.eW)(async(t,e)=>{let a;let{labelStyles:r,nodeStyles:l}=u(e);e.labelStyle=r;let{shapeSvg:i,bbox:n,label:s,halfPadding:h}=await G(t,e,tt(e)),o="neo"===e.look?2*h:h,c=n.height+o,g=c/2,y=g/(2.5+c/50),p=n.width+y+o,{cssStyles:f}=e;if("handDrawn"===e.look){let t=d.Z.svg(i),r=t0(0,0,p,c,y,g),l=t2(0,0,p,c,y,g),n=t.path(r,m(e,{})),s=t.path(l,m(e,{fill:"none"}));a=i.insert(()=>s,":first-child"),(a=i.insert(()=>n,":first-child")).attr("class","basic label-container"),f&&a.attr("style",f)}else{let t=tK(0,0,p,c,y,g);a=i.insert("path",":first-child").attr("d",t).attr("class","basic label-container").attr("style",f).attr("style",l)}return a.attr("class","basic label-container"),f&&"handDrawn"!==e.look&&a.selectAll("path").attr("style",f),l&&"handDrawn"!==e.look&&a.selectAll("path").attr("style",l),a.attr("label-offset-x",y),a.attr("transform",`translate(${-p/2}, ${c/2} )`),s.attr("transform",`translate(${-(n.width/2)-y-(n.x-(n.left??0))}, ${-(n.height/2)-(n.y-(n.top??0))})`),K(e,a),e.intersect=function(t){let a=td.rect(e,t),r=a.y-(e.y??0);if(0!=g&&(Math.abs(r)<(e.height??0)/2||Math.abs(r)==(e.height??0)/2&&Math.abs(a.x-(e.x??0))>(e.width??0)/2-y)){let l=y*y*(1-r*r/(g*g));0!=l&&(l=Math.sqrt(l)),l=y-l,t.x-(e.x??0)>0&&(l=-l),a.x+=l}return a},i},"tiltedCylinder"),t5=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i}=await G(t,e,tt(e)),n=Math.max(60,i.width+(e.padding??0)*2,e?.width??0),s=Math.max(20,i.height+(e.padding??0)*2,e?.height??0),{cssStyles:h}=e,o=d.Z.svg(l),c=m(e,{});"handDrawn"!==e.look&&(c.roughness=0,c.fillStyle="solid");let g=[{x:-n/2*.8,y:-s/2},{x:n/2*.8,y:-s/2},{x:n/2,y:-s/2*.6},{x:n/2,y:s/2},{x:-n/2,y:s/2},{x:-n/2,y:-s/2*.6}],y=te(g),p=o.path(y,c),f=l.insert(()=>p,":first-child");return f.attr("class","basic label-container"),h&&"handDrawn"!==e.look&&f.selectChildren("path").attr("style",h),r&&"handDrawn"!==e.look&&f.selectChildren("path").attr("style",r),K(e,f),e.intersect=function(t){return td.polygon(e,g,t)},l},"trapezoidalPentagon"),t8=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i,label:n}=await G(t,e,tt(e)),h=i.width+(e.padding??0),o=h+i.height,c=h+i.height,g=[{x:0,y:-o},{x:c,y:-o},{x:c/2,y:0}],{cssStyles:y}=e,p=d.Z.svg(l),f=m(e,{});"handDrawn"!==e.look&&(f.roughness=0,f.fillStyle="solid");let x=te(g),w=p.path(x,f),b=l.insert(()=>w,":first-child").attr("transform",`translate(${-o/2}, ${o/2})`);return y&&"handDrawn"!==e.look&&b.selectChildren("path").attr("style",y),r&&"handDrawn"!==e.look&&b.selectChildren("path").attr("style",r),e.width=h,e.height=o,K(e,b),n.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${-o/2+(e.padding??0)/2+(i.y-(i.top??0))})`),e.intersect=function(t){return s.cM.info("Triangle intersect",e,g,t),td.polygon(e,g,t)},l},"flippedTriangle"),t9=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.label="",e.labelStyle=a;let{shapeSvg:l}=await G(t,e,tt(e)),i=Math.max(30,e?.width??0),n=Math.max(30,e?.height??0),{cssStyles:h}=e,o=d.Z.svg(l),c=m(e,{});"handDrawn"!==e.look&&(c.roughness=0,c.fillStyle="solid");let g=[{x:0,y:0},{x:i,y:0},{x:0,y:n},{x:i,y:n}],y=te(g),p=o.path(y,c),f=l.insert(()=>p,":first-child");return f.attr("class","basic label-container"),h&&"handDrawn"!==e.look&&f.selectChildren("path").attr("style",h),r&&"handDrawn"!==e.look&&f.selectChildren("path").attr("style",r),f.attr("transform",`translate(${-i/2}, ${-n/2})`),K(e,f),e.intersect=function(t){return s.cM.info("Pill intersect",e,{points:g}),td.polygon(e,g,t)},l},"hourglass"),t7=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i}=await G(t,e,tt(e)),n=Math.max(i.width+(e.padding??0)*2,e?.width??0),s=Math.max(i.height+(e.padding??0)*2,e?.height??0),h=-n/2,o=-s/2,c=.2*s,{cssStyles:g}=e,y=d.Z.svg(l),p=m(e,{}),f=[{x:h-c/2,y:o},{x:h+n+c/2,y:o},{x:h+n+c/2,y:o+s},{x:h-c/2,y:o+s}];"handDrawn"!==e.look&&(p.roughness=0,p.fillStyle="solid");let x=te(f),w=y.path(x,p),b=te([{x:h+n-c/2,y:o+s},{x:h+n+c/2,y:o+s},{x:h+n+c/2,y:o+s-.2*s}]),k=y.path(b,{...p,fillStyle:"solid"}),$=l.insert(()=>k,":first-child");return $.insert(()=>w,":first-child"),$.attr("class","basic label-container"),g&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",g),r&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",r),K(e,$),e.intersect=function(t){return td.polygon(e,f,t)},l},"taggedRect"),t4=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i,label:n}=await G(t,e,tt(e)),s=Math.max(i.width+(e.padding??0)*2,e?.width??0),h=Math.max(i.height+(e.padding??0)*2,e?.height??0),o=-s/2,c=-h/2,{cssStyles:g}=e,y=d.Z.svg(l),p=m(e,{}),f=[{x:o-5,y:c+5},{x:o-5,y:c+h+5},{x:o+s-5,y:c+h+5},{x:o+s-5,y:c+h},{x:o+s,y:c+h},{x:o+s,y:c+h-5},{x:o+s+5,y:c+h-5},{x:o+s+5,y:c-5},{x:o+5,y:c-5},{x:o+5,y:c},{x:o,y:c},{x:o,y:c+5}];"handDrawn"!==e.look&&(p.roughness=0,p.fillStyle="solid");let x=te(f),w=y.path(x,p),b=te([{x:o,y:c+5},{x:o+s-5,y:c+5},{x:o+s-5,y:c+h},{x:o+s,y:c+h},{x:o+s,y:c},{x:o,y:c}]),k=y.path(b,{...p,fill:"none"}),$=l.insert(()=>k,":first-child");return $.insert(()=>w,":first-child"),$.attr("class","basic label-container"),g&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",g),r&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",r),n.attr("transform",`translate(${-(i.width/2)-5-(i.x-(i.left??0))}, ${-(i.height/2)+5-(i.y-(i.top??0))})`),K(e,$),e.intersect=function(t){return td.polygon(e,f,t)},l},"multiRect"),t3=(0,s.eW)((t,e,a,r,l,i,n)=>`M${t},${e+i} a${l},${i} 0,0,0 ${a},0 a${l},${i} 0,0,0 ${-a},0 l0,${r} a${l},${i} 0,0,0 ${a},0 l0,${-r} M${t},${e+i+n} a${l},${i} 0,0,0 ${a},0`,"createCylinderPathD"),t6=(0,s.eW)((t,e,a,r,l,i,n)=>`M${t},${e+i} M${t+a},${e+i} a${l},${i} 0,0,0 ${-a},0 l0,${r} a${l},${i} 0,0,0 ${a},0 l0,${-r} M${t},${e+i+n} a${l},${i} 0,0,0 ${a},0`,"createOuterCylinderPathD"),et=(0,s.eW)((t,e,a,r,l,i)=>`M${t-a/2},${-r/2} a${l},${i} 0,0,0 ${a},0`,"createInnerCylinderPathD"),ee=(0,s.eW)(async(t,e)=>{let a;let{labelStyles:r,nodeStyles:l}=u(e);e.labelStyle=r;let{shapeSvg:i,bbox:n,label:s}=await G(t,e,tt(e)),h=Math.max(n.width+(e.padding??0),e.width??0),o=h/2,c=o/(2.5+h/50),g=Math.max(n.height+c+(e.padding??0),e.height??0),y=.1*g,{cssStyles:p}=e;if("handDrawn"===e.look){let t=d.Z.svg(i),r=t6(0,0,h,g,o,c,y),l=et(0,c,h,g,o,c),n=m(e,{}),s=t.path(r,n),f=t.path(l,n);i.insert(()=>f,":first-child").attr("class","line"),(a=i.insert(()=>s,":first-child")).attr("class","basic label-container"),p&&a.attr("style",p)}else{let t=t3(0,0,h,g,o,c,y);a=i.insert("path",":first-child").attr("d",t).attr("class","basic label-container").attr("style",p).attr("style",l)}return a.attr("label-offset-y",c),a.attr("transform",`translate(${-h/2}, ${-(g/2+c)})`),K(e,a),s.attr("transform",`translate(${-(n.width/2)-(n.x-(n.left??0))}, ${-(n.height/2)+c-(n.y-(n.top??0))})`),e.intersect=function(t){let a=td.rect(e,t),r=a.x-(e.x??0);if(0!=o&&(Math.abs(r)<(e.width??0)/2||Math.abs(r)==(e.width??0)/2&&Math.abs(a.y-(e.y??0))>(e.height??0)/2-c)){let l=c*c*(1-r*r/(o*o));l>0&&(l=Math.sqrt(l)),l=c-l,t.y-(e.y??0)>0&&(l=-l),a.y+=l}return a},i},"linedCylinder"),ea=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i,label:n}=await G(t,e,tt(e)),s=Math.max(i.width+(e.padding??0)*2,e?.width??0),h=Math.max(i.height+(e.padding??0)*2,e?.height??0),o=h/8,c=h+o,{cssStyles:g}=e,y=70-s,p=y>0?y/2:0,f=d.Z.svg(l),x=m(e,{});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");let w=[{x:-s/2-p,y:c/2},...ta(-s/2-p,c/2,s/2+p,c/2,o,.8),{x:s/2+p,y:-c/2},{x:-s/2-p,y:-c/2}],b=te(w),k=f.path(b,x),$=l.insert(()=>k,":first-child");return $.attr("class","basic label-container"),g&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",g),r&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",r),$.attr("transform",`translate(0,${-o/2})`),n.attr("transform",`translate(${-s/2+(e.padding??0)-(i.x-(i.left??0))},${-h/2+(e.padding??0)-o-(i.y-(i.top??0))})`),K(e,$),e.intersect=function(t){return td.polygon(e,w,t)},l},"waveEdgedRectangle"),er=(0,s.eW)((t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.label="",e.labelStyle=a;let l=t.insert("g").attr("class",tt(e)).attr("id",e.domId??e.id),{cssStyles:i}=e,n=Math.max(35,e?.width??0),h=Math.max(35,e?.height??0),o=[{x:n,y:0},{x:0,y:h+3.5},{x:n-14,y:h+3.5},{x:0,y:2*h},{x:n,y:h-3.5},{x:14,y:h-3.5}],c=d.Z.svg(l),g=m(e,{});"handDrawn"!==e.look&&(g.roughness=0,g.fillStyle="solid");let y=te(o),p=c.path(y,g),f=l.insert(()=>p,":first-child");return i&&"handDrawn"!==e.look&&f.selectAll("path").attr("style",i),r&&"handDrawn"!==e.look&&f.selectAll("path").attr("style",r),f.attr("transform",`translate(-${n/2},${-h})`),K(e,f),e.intersect=function(t){return s.cM.info("lightningBolt intersect",e,t),td.polygon(e,o,t)},l},"lightningBolt"),el=(0,s.eW)((t,e,{config:{themeVariables:a}})=>{let{labelStyles:r,nodeStyles:l}=u(e);e.label="",e.labelStyle=r;let i=t.insert("g").attr("class",tt(e)).attr("id",e.domId??e.id),{cssStyles:n}=e,h=d.Z.svg(i),{nodeBorder:o}=a,c=m(e,{fillStyle:"solid"});"handDrawn"!==e.look&&(c.roughness=0);let g=h.circle(0,0,14,c),y=i.insert(()=>g,":first-child");return y.selectAll("path").attr("style",`fill: ${o} !important;`),n&&n.length>0&&"handDrawn"!==e.look&&y.selectAll("path").attr("style",n),l&&"handDrawn"!==e.look&&y.selectAll("path").attr("style",l),K(e,y),e.intersect=function(t){return s.cM.info("filledCircle intersect",e,{radius:7,point:t}),td.circle(e,7,t)},i},"filledCircle"),ei=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i,label:n}=await G(t,e,tt(e)),s=Math.max(i.width+(e.padding??0)*2,e?.width??0),h=Math.max(i.height+(e.padding??0)*2,e?.height??0),o=h/4,c=h+o,g=-s/2,y=-c/2,{cssStyles:p}=e,f=ta(g-5,y+c+5,g+s-5,y+c+5,o,.8),x=f?.[f.length-1],w=[{x:g-5,y:y+5},{x:g-5,y:y+c+5},...f,{x:g+s-5,y:x.y-5},{x:g+s,y:x.y-5},{x:g+s,y:x.y-10},{x:g+s+5,y:x.y-10},{x:g+s+5,y:y-5},{x:g+5,y:y-5},{x:g+5,y},{x:g,y},{x:g,y:y+5}],b=[{x:g,y:y+5},{x:g+s-5,y:y+5},{x:g+s-5,y:x.y-5},{x:g+s,y:x.y-5},{x:g+s,y},{x:g,y}],k=d.Z.svg(l),$=m(e,{});"handDrawn"!==e.look&&($.roughness=0,$.fillStyle="solid");let M=te(w),W=k.path(M,$),S=te(b),D=k.path(S,$),v=l.insert(()=>W,":first-child");return v.insert(()=>D),v.attr("class","basic label-container"),p&&"handDrawn"!==e.look&&v.selectAll("path").attr("style",p),r&&"handDrawn"!==e.look&&v.selectAll("path").attr("style",r),v.attr("transform",`translate(0,${-o/2})`),n.attr("transform",`translate(${-(i.width/2)-5-(i.x-(i.left??0))}, ${-(i.height/2)+5-o/2-(i.y-(i.top??0))})`),K(e,v),e.intersect=function(t){return td.polygon(e,w,t)},l},"multiWaveEdgedRectangle"),en=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i,label:n}=await G(t,e,tt(e)),s=Math.max(i.width+(e.padding??0)*2,e?.width??0),h=Math.max(i.height+(e.padding??0)*2,e?.height??0),o=-s/2,c=-h/2,{cssStyles:g}=e,y=d.Z.svg(l),p=m(e,{}),f=[{x:o-5,y:c-5},{x:o-5,y:c+h},{x:o+s,y:c+h},{x:o+s,y:c-5}],x=`M${o-5},${c-5} L${o+s},${c-5} L${o+s},${c+h} L${o-5},${c+h} L${o-5},${c-5}
                M${o-5},${c} L${o+s},${c}
                M${o},${c-5} L${o},${c+h}`;"handDrawn"!==e.look&&(p.roughness=0,p.fillStyle="solid");let w=y.path(x,p),b=l.insert(()=>w,":first-child");return b.attr("transform","translate(2.5, 2.5)"),b.attr("class","basic label-container"),g&&"handDrawn"!==e.look&&b.selectAll("path").attr("style",g),r&&"handDrawn"!==e.look&&b.selectAll("path").attr("style",r),n.attr("transform",`translate(${-(i.width/2)+2.5-(i.x-(i.left??0))}, ${-(i.height/2)+2.5-(i.y-(i.top??0))})`),K(e,b),e.intersect=function(t){return td.polygon(e,f,t)},l},"windowPane"),es=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i,label:n}=await G(t,e,tt(e)),s=Math.max(i.width+(e.padding??0)*2,e?.width??0),h=Math.max(i.height+(e.padding??0)*2,e?.height??0),o=h/4,c=h+o,{cssStyles:g}=e,y=d.Z.svg(l),p=m(e,{});"handDrawn"!==e.look&&(p.roughness=0,p.fillStyle="solid");let f=[{x:-s/2-s/2*.1,y:-c/2},{x:-s/2-s/2*.1,y:c/2},...ta(-s/2-s/2*.1,c/2,s/2+s/2*.1,c/2,o,.8),{x:s/2+s/2*.1,y:-c/2},{x:-s/2-s/2*.1,y:-c/2},{x:-s/2,y:-c/2},{x:-s/2,y:c/2*1.1},{x:-s/2,y:-c/2}],x=y.polygon(f.map(t=>[t.x,t.y]),p),w=l.insert(()=>x,":first-child");return w.attr("class","basic label-container"),g&&"handDrawn"!==e.look&&w.selectAll("path").attr("style",g),r&&"handDrawn"!==e.look&&w.selectAll("path").attr("style",r),w.attr("transform",`translate(0,${-o/2})`),n.attr("transform",`translate(${-s/2+(e.padding??0)+s/2*.1/2-(i.x-(i.left??0))},${-h/2+(e.padding??0)-o/2-(i.y-(i.top??0))})`),K(e,w),e.intersect=function(t){return td.polygon(e,f,t)},l},"linedWaveEdgedRect"),eh=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i,label:n}=await G(t,e,tt(e)),s=Math.max(i.width+(e.padding??0)*2,e?.width??0),h=Math.max(i.height+(e.padding??0)*2,e?.height??0),o=h/4,c=.2*s,g=.2*h,y=h+o,{cssStyles:p}=e,f=d.Z.svg(l),x=m(e,{});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");let w=[{x:-s/2-s/2*.1,y:y/2},...ta(-s/2-s/2*.1,y/2,s/2+s/2*.1,y/2,o,.8),{x:s/2+s/2*.1,y:-y/2},{x:-s/2-s/2*.1,y:-y/2}],b=-s/2+s/2*.1,k=-y/2-.4*g,$=[{x:b+s-c,y:(k+h)*1.4},{x:b+s,y:k+h-g},{x:b+s,y:(k+h)*.9},...ta(b+s,(k+h)*1.3,b+s-c,(k+h)*1.5,-(.03*h),.5)],M=te(w),W=f.path(M,x),S=te($),D=f.path(S,{...x,fillStyle:"solid"}),v=l.insert(()=>D,":first-child");return v.insert(()=>W,":first-child"),v.attr("class","basic label-container"),p&&"handDrawn"!==e.look&&v.selectAll("path").attr("style",p),r&&"handDrawn"!==e.look&&v.selectAll("path").attr("style",r),v.attr("transform",`translate(0,${-o/2})`),n.attr("transform",`translate(${-s/2+(e.padding??0)-(i.x-(i.left??0))},${-h/2+(e.padding??0)-o/2-(i.y-(i.top??0))})`),K(e,v),e.intersect=function(t){return td.polygon(e,w,t)},l},"taggedWaveEdgedRectangle");function ed(t,e,a,r=100,l=0,i=180){let n=[],s=l*Math.PI/180,h=(i*Math.PI/180-s)/(r-1);for(let l=0;l<r;l++){let r=s+l*h,i=t+a*Math.cos(r),d=e+a*Math.sin(r);n.push({x:-i,y:-d})}return n}(0,s.eW)(ed,"generateCirclePoints");var eo=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i,label:n}=await G(t,e,tt(e)),s=i.width+(e.padding??0),h=i.height+(e.padding??0),o=Math.max(5,.1*h),{cssStyles:c}=e,g=[...ed(s/2,-h/2,o,30,-90,0),{x:-s/2-o,y:o},...ed(s/2+2*o,-o,o,20,-180,-270),...ed(s/2+2*o,o,o,20,-90,-180),{x:-s/2-o,y:-h/2},...ed(s/2,h/2,o,20,0,90)],y=[{x:s/2,y:-h/2-o},{x:-s/2,y:-h/2-o},...ed(s/2,-h/2,o,20,-90,0),{x:-s/2-o,y:-o},...ed(s/2+.1*s,-o,o,20,-180,-270),...ed(s/2+.1*s,o,o,20,-90,-180),{x:-s/2-o,y:h/2},...ed(s/2,h/2,o,20,0,90),{x:-s/2,y:h/2+o},{x:s/2,y:h/2+o}],p=d.Z.svg(l),f=m(e,{fill:"none"});"handDrawn"!==e.look&&(f.roughness=0,f.fillStyle="solid");let x=te(g).replace("Z",""),w=p.path(x,f),b=te(y),k=p.path(b,{...f}),$=l.insert("g",":first-child");return $.insert(()=>k,":first-child").attr("stroke-opacity",0),$.insert(()=>w,":first-child"),$.attr("class","text"),c&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",c),r&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",r),$.attr("transform",`translate(${o}, 0)`),n.attr("transform",`translate(${-s/2+o-(i.x-(i.left??0))},${-h/2+(e.padding??0)/2-(i.y-(i.top??0))})`),K(e,$),e.intersect=function(t){return td.polygon(e,y,t)},l},"curlyBraceLeft");function ec(t,e,a,r=100,l=0,i=180){let n=[],s=l*Math.PI/180,h=(i*Math.PI/180-s)/(r-1);for(let l=0;l<r;l++){let r=s+l*h,i=t+a*Math.cos(r),d=e+a*Math.sin(r);n.push({x:i,y:d})}return n}(0,s.eW)(ec,"generateCirclePoints");var eg=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i,label:n}=await G(t,e,tt(e)),s=i.width+(e.padding??0),h=i.height+(e.padding??0),o=Math.max(5,.1*h),{cssStyles:c}=e,g=[...ec(s/2,-h/2,o,20,-90,0),{x:s/2+o,y:-o},...ec(s/2+2*o,-o,o,20,-180,-270),...ec(s/2+2*o,o,o,20,-90,-180),{x:s/2+o,y:h/2},...ec(s/2,h/2,o,20,0,90)],y=[{x:-s/2,y:-h/2-o},{x:s/2,y:-h/2-o},...ec(s/2,-h/2,o,20,-90,0),{x:s/2+o,y:-o},...ec(s/2+2*o,-o,o,20,-180,-270),...ec(s/2+2*o,o,o,20,-90,-180),{x:s/2+o,y:h/2},...ec(s/2,h/2,o,20,0,90),{x:s/2,y:h/2+o},{x:-s/2,y:h/2+o}],p=d.Z.svg(l),f=m(e,{fill:"none"});"handDrawn"!==e.look&&(f.roughness=0,f.fillStyle="solid");let x=te(g).replace("Z",""),w=p.path(x,f),b=te(y),k=p.path(b,{...f}),$=l.insert("g",":first-child");return $.insert(()=>k,":first-child").attr("stroke-opacity",0),$.insert(()=>w,":first-child"),$.attr("class","text"),c&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",c),r&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",r),$.attr("transform",`translate(${-o}, 0)`),n.attr("transform",`translate(${-s/2+(e.padding??0)/2-(i.x-(i.left??0))},${-h/2+(e.padding??0)/2-(i.y-(i.top??0))})`),K(e,$),e.intersect=function(t){return td.polygon(e,y,t)},l},"curlyBraceRight");function ey(t,e,a,r=100,l=0,i=180){let n=[],s=l*Math.PI/180,h=(i*Math.PI/180-s)/(r-1);for(let l=0;l<r;l++){let r=s+l*h,i=t+a*Math.cos(r),d=e+a*Math.sin(r);n.push({x:-i,y:-d})}return n}(0,s.eW)(ey,"generateCirclePoints");var ep=(0,s.eW)(async(t,e)=>{let{labelStyles:a,nodeStyles:r}=u(e);e.labelStyle=a;let{shapeSvg:l,bbox:i,label:n}=await G(t,e,tt(e)),s=i.width+(e.padding??0),h=i.height+(e.padding??0),o=Math.max(5,.1*h),{cssStyles:c}=e,g=[...ey(s/2,-h/2,o,30,-90,0),{x:-s/2-o,y:o},...ey(s/2+2*o,-o,o,20,-180,-270),...ey(s/2+2*o,o,o,20,-90,-180),{x:-s/2-o,y:-h/2},...ey(s/2,h/2,o,20,0,90)],y=[...ey(-s/2+o+o/2,-h/2,o,20,-90,-180),{x:s/2-o/2,y:o},...ey(-s/2-o/2,-o,o,20,0,90),...ey(-s/2-o/2,o,o,20,-90,0),{x:s/2-o/2,y:-o},...ey(-s/2+o+o/2,h/2,o,30,-180,-270)],p=[{x:s/2,y:-h/2-o},{x:-s/2,y:-h/2-o},...ey(s/2,-h/2,o,20,-90,0),{x:-s/2-o,y:-o},...ey(s/2+2*o,-o,o,20,-180,-270),...ey(s/2+2*o,o,o,20,-90,-180),{x:-s/2-o,y:h/2},...ey(s/2,h/2,o,20,0,90),{x:-s/2,y:h/2+o},{x:s/2-o-o/2,y:h/2+o},...ey(-s/2+o+o/2,-h/2,o,20,-90,-180),{x:s/2-o/2,y:o},...ey(-s/2-o/2,-o,o,20,0,90),...ey(-s/2-o/2,o,o,20,-90,0),{x:s/2-o/2,y:-o},...ey(-s/2+o+o/2,h/2,o,30,-180,-270)],f=d.Z.svg(l),x=m(e,{fill:"none"});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");let w=te(g).replace("Z",""),b=f.path(w,x),k=te(y).replace("Z",""),$=f.path(k,x),M=te(p),W=f.path(M,{...x}),S=l.insert("g",":first-child");return S.insert(()=>W,":first-child").attr("stroke-opacity",0),S.insert(()=>b,":first-child"),S.insert(()=>$,":first-child"),S.attr("class","text"),c&&"handDrawn"!==e.look&&S.selectAll("path").attr("style",c),r&&"handDrawn"!==e.look&&S.selectAll("path").attr("style",r),S.attr("transform",`translate(${o-o/4}, 0)`),n.attr("transform",`translate(${-s/2+(e.padding??0)/2-(i.x-(i.left??0))},${-h/2+(e.padding??0)/2-(i.y-(i.top??0))})`),K(e,S),e.intersect=function(t){return td.polygon(e,p,t)},l},"curlyBraces"),ef=(0,s.eW)(async(t,e,{config:{themeVariables:a,flowchart:l}})=>{let{labelStyles:i}=u(e);e.labelStyle=i;let n=Math.max(e.assetHeight??48,e.assetWidth??48),h=l?.wrappingWidth;e.width=Math.max(n,h??0);let{shapeSvg:o,bbox:c,halfPadding:g,label:y}=await G(t,e,"icon-shape default"),p="t"===e.pos,f=n+2*g,w=n+2*g,{nodeBorder:b,mainBkg:k}=a,{stylesMap:$}=x(e),M=e.label?8:0,W=d.Z.svg(o),S=m(e,{stroke:$.get("fill")||k});"handDrawn"!==e.look&&(S.roughness=0,S.fillStyle="solid");let D=W.rectangle(-w/2,-f/2,w,f,S),v=Math.max(w,c.width),L=f+c.height+M,C=W.rectangle(-v/2,-L/2,v,L,{...S,fill:"transparent",stroke:"none"}),P=o.insert(()=>D,":first-child"),A=o.insert(()=>C);if(e.icon){let t=o.append("g");t.html(`<g>${await (0,r.s4)(e.icon,{height:n,width:n,fallbackPrefix:""})}</g>`);let a=t.node().getBBox(),l=a.width,i=a.height,s=a.x,h=a.y;t.attr("transform",`translate(${-l/2-s},${p?c.height/2+M/2-i/2-h:-c.height/2-M/2-i/2-h})`),t.selectAll("path").attr("fill",$.get("stroke")??b)}return y.attr("transform",`translate(${-c.width/2-(c.x-(c.left??0))},${p?-L/2:L/2-c.height})`),P.attr("transform",`translate(0,${p?c.height/2+M/2:-c.height/2-M/2})`),K(e,A),e.intersect=function(t){if(s.cM.info("iconSquare intersect",e,t),!e.label)return td.rect(e,t);let a=e.x??0,r=e.y??0,l=e.height??0,i=[];return i=p?[{x:a-c.width/2,y:r-l/2},{x:a+c.width/2,y:r-l/2},{x:a+c.width/2,y:r-l/2+c.height+M},{x:a+w/2,y:r-l/2+c.height+M},{x:a+w/2,y:r+l/2},{x:a-w/2,y:r+l/2},{x:a-w/2,y:r-l/2+c.height+M},{x:a-c.width/2,y:r-l/2+c.height+M}]:[{x:a-w/2,y:r-l/2},{x:a+w/2,y:r-l/2},{x:a+w/2,y:r-l/2+f},{x:a+c.width/2,y:r-l/2+f},{x:a+c.width/2/2,y:r+l/2},{x:a-c.width/2,y:r+l/2},{x:a-c.width/2,y:r-l/2+f},{x:a-w/2,y:r-l/2+f}],td.polygon(e,i,t)},o},"iconSquare"),ex=(0,s.eW)(async(t,e,{config:{themeVariables:a,flowchart:l}})=>{let{labelStyles:i}=u(e);e.labelStyle=i;let n=Math.max(e.assetHeight??48,e.assetWidth??48),h=l?.wrappingWidth;e.width=Math.max(n,h??0);let{shapeSvg:o,bbox:c,label:g}=await G(t,e,"icon-shape default"),y=e.label?8:0,p="t"===e.pos,{nodeBorder:f,mainBkg:w}=a,{stylesMap:b}=x(e),k=d.Z.svg(o),$=m(e,{stroke:b.get("fill")||w});"handDrawn"!==e.look&&($.roughness=0,$.fillStyle="solid");let M=o.append("g");e.icon&&M.html(`<g>${await (0,r.s4)(e.icon,{height:n,width:n,fallbackPrefix:""})}</g>`);let W=M.node().getBBox(),S=W.width,D=W.height,v=W.x,L=W.y,C=Math.max(S,D)*Math.SQRT2+40,P=k.circle(0,0,C,$),A=Math.max(C,c.width),Z=C+c.height+y,B=k.rectangle(-A/2,-Z/2,A,Z,{...$,fill:"transparent",stroke:"none"}),R=o.insert(()=>P,":first-child"),E=o.insert(()=>B);return M.attr("transform",`translate(${-S/2-v},${p?c.height/2+y/2-D/2-L:-c.height/2-y/2-D/2-L})`),M.selectAll("path").attr("fill",b.get("stroke")||f),g.attr("transform",`translate(${-c.width/2-(c.x-(c.left??0))},${p?-Z/2:Z/2-c.height})`),R.attr("transform",`translate(0,${p?c.height/2+y/2:-c.height/2-y/2})`),K(e,E),e.intersect=function(t){return s.cM.info("iconSquare intersect",e,t),td.rect(e,t)},o},"iconCircle"),ew=(0,s.eW)(async(t,e,{config:{themeVariables:a,flowchart:l}})=>{let{labelStyles:i}=u(e);e.labelStyle=i;let n=Math.max(e.assetHeight??48,e.assetWidth??48),h=l?.wrappingWidth;e.width=Math.max(n,h??0);let{shapeSvg:o,bbox:c,label:g}=await G(t,e,"icon-shape default"),y="t"===e.pos,{nodeBorder:p}=a,{stylesMap:f}=x(e),w=-n/2,b=-n/2,k=e.label?8:0,$=d.Z.svg(o),M=m(e,{stroke:"none",fill:"none"});"handDrawn"!==e.look&&(M.roughness=0,M.fillStyle="solid");let W=$.rectangle(w,b,n,n,M),S=Math.max(n,c.width),D=n+c.height+k,v=$.rectangle(-S/2,-D/2,S,D,{...M,fill:"transparent",stroke:"none"}),L=o.insert(()=>W,":first-child"),C=o.insert(()=>v);if(e.icon){let t=o.append("g");t.html(`<g>${await (0,r.s4)(e.icon,{height:n,width:n,fallbackPrefix:""})}</g>`);let a=t.node().getBBox(),l=a.width,i=a.height,s=a.x,h=a.y;t.attr("transform",`translate(${-l/2-s},${y?c.height/2+k/2-i/2-h:-c.height/2-k/2-i/2-h})`),t.selectAll("path").attr("fill",f.get("stroke")||p)}return g.attr("transform",`translate(${-c.width/2-(c.x-(c.left??0))},${y?-D/2:D/2-c.height})`),L.attr("transform",`translate(0,${y?c.height/2+k/2:-c.height/2-k/2})`),K(e,C),e.intersect=function(t){if(s.cM.info("iconSquare intersect",e,t),!e.label)return td.rect(e,t);let a=e.x??0,r=e.y??0,l=e.height??0,i=[];return i=y?[{x:a-c.width/2,y:r-l/2},{x:a+c.width/2,y:r-l/2},{x:a+c.width/2,y:r-l/2+c.height+k},{x:a+n/2,y:r-l/2+c.height+k},{x:a+n/2,y:r+l/2},{x:a-n/2,y:r+l/2},{x:a-n/2,y:r-l/2+c.height+k},{x:a-c.width/2,y:r-l/2+c.height+k}]:[{x:a-n/2,y:r-l/2},{x:a+n/2,y:r-l/2},{x:a+n/2,y:r-l/2+n},{x:a+c.width/2,y:r-l/2+n},{x:a+c.width/2/2,y:r+l/2},{x:a-c.width/2,y:r+l/2},{x:a-c.width/2,y:r-l/2+n},{x:a-n/2,y:r-l/2+n}],td.polygon(e,i,t)},o},"icon"),eu=(0,s.eW)(async(t,e,{config:{flowchart:a}})=>{let r=new Image;r.src=e?.img??"",await r.decode();let l=Number(r.naturalWidth.toString().replace("px","")),i=Number(r.naturalHeight.toString().replace("px",""));e.imageAspectRatio=l/i;let{labelStyles:n}=u(e);e.labelStyle=n;let h=a?.wrappingWidth;e.defaultWidth=a?.wrappingWidth;let o=Math.max(e.label?h??0:0,e?.assetWidth??l),c="on"===e.constraint&&e?.assetHeight?e.assetHeight*e.imageAspectRatio:o,g="on"===e.constraint?c/e.imageAspectRatio:e?.assetHeight??i;e.width=Math.max(c,h??0);let{shapeSvg:y,bbox:p,label:f}=await G(t,e,"image-shape default"),x="t"===e.pos,w=-c/2,b=e.label?8:0,k=d.Z.svg(y),$=m(e,{});"handDrawn"!==e.look&&($.roughness=0,$.fillStyle="solid");let M=k.rectangle(w,-g/2,c,g,$),W=Math.max(c,p.width),S=g+p.height+b,D=k.rectangle(-W/2,-S/2,W,S,{...$,fill:"none",stroke:"none"}),v=y.insert(()=>M,":first-child"),L=y.insert(()=>D);if(e.img){let t=y.append("image");t.attr("href",e.img),t.attr("width",c),t.attr("height",g),t.attr("preserveAspectRatio","none"),t.attr("transform",`translate(${-c/2},${x?S/2-g:-S/2})`)}return f.attr("transform",`translate(${-p.width/2-(p.x-(p.left??0))},${x?-g/2-p.height/2-b/2:g/2-p.height/2+b/2})`),v.attr("transform",`translate(0,${x?p.height/2+b/2:-p.height/2-b/2})`),K(e,L),e.intersect=function(t){if(s.cM.info("iconSquare intersect",e,t),!e.label)return td.rect(e,t);let a=e.x??0,r=e.y??0,l=e.height??0,i=[];return i=x?[{x:a-p.width/2,y:r-l/2},{x:a+p.width/2,y:r-l/2},{x:a+p.width/2,y:r-l/2+p.height+b},{x:a+c/2,y:r-l/2+p.height+b},{x:a+c/2,y:r+l/2},{x:a-c/2,y:r+l/2},{x:a-c/2,y:r-l/2+p.height+b},{x:a-p.width/2,y:r-l/2+p.height+b}]:[{x:a-c/2,y:r-l/2},{x:a+c/2,y:r-l/2},{x:a+c/2,y:r-l/2+g},{x:a+p.width/2,y:r-l/2+g},{x:a+p.width/2/2,y:r+l/2},{x:a-p.width/2,y:r+l/2},{x:a-p.width/2,y:r-l/2+g},{x:a-c/2,y:r-l/2+g}],td.polygon(e,i,t)},y},"imageSquare"),em={state:tc,stateStart:tp,stateEnd:tf,forkJoin:tx,choice:tw,note:tu,rectWithTitle:tb,roundedRect:tg,squareRect:ty,rectangle:ty,rect:ty,process:ty,proc:ty,rounded:tg,event:tg,stadium:tm,pill:tm,terminal:tm,subroutine:t$,"framed-rectangle":t$,"fr-rect":t$,subprocess:t$,subproc:t$,cylinder:tD,db:tD,cyl:tD,database:tD,question:tA,diam:tA,diamond:tA,decision:tA,hexagon:tB,hex:tB,prepare:tB,lean_right:t_,"lean-r":t_,"lean-right":t_,"in-out":t_,lean_left:tY,"lean-l":tY,"lean-left":tY,"out-in":tY,trapezoid:tH,"trap-b":tH,"trapezoid-bottom":tH,priority:tH,inv_trapezoid:tN,"inv-trapezoid":tN,"trapezoid-top":tN,"trap-t":tN,manual:tN,doublecircle:tL,"dbl-circ":tL,"double-circle":tL,circle:tv,circ:tv,rect_left_inv_arrow:tC,odd:tC,card:tE,"notched-rectangle":tE,"notch-rect":tE,"lined-rectangle":tT,"lin-rect":tT,"lin-proc":tT,"lined-process":tT,"shaded-process":tT,"small-circle":tp,"sm-circ":tp,start:tp,stop:tf,"framed-circle":tf,"fr-circ":tf,join:tx,fork:tx,comment:eo,"brace-l":eo,bolt:er,"com-link":er,"lightning-bolt":er,doc:ea,document:ea,delay:tq,"half-rounded-rectangle":tq,"horizontal-cylinder":t1,"h-cyl":t1,das:t1,"lined-cylinder":ee,"lin-cyl":ee,disk:ee,"curved-trapezoid":tj,"curv-trap":tj,display:tj,"divided-rectangle":tJ,"div-rect":tJ,"div-proc":tJ,"divided-process":tJ,triangle:tX,tri:tX,extract:tX,"window-pane":en,"win-pane":en,"internal-storage":en,"f-circ":el,junction:el,"filled-circle":el,"lin-doc":es,"lined-document":es,"notched-pentagon":t5,"notch-pent":t5,"loop-limit":t5,"flipped-triangle":t8,"flip-tri":t8,"manual-file":t8,"sloped-rectangle":tO,"sl-rect":tO,"manual-input":tO,docs:ei,documents:ei,"st-doc":ei,"stacked-document":ei,processes:t4,procs:t4,"stacked-rectangle":t4,"st-rect":t4,flag:tG,"paper-tape":tG,"bow-tie-rectangle":tz,"bow-rect":tz,"stored-data":tz,"crossed-circle":tQ,"cross-circ":tQ,summary:tQ,"tag-doc":eh,"tagged-document":eh,"tag-rect":t7,"tagged-rectangle":t7,"tag-proc":t7,"tagged-process":t7,hourglass:t9,collate:t9,text:tR,anchor:tI,brace:eo,labelRect:tV,"brace-r":eg,braces:ep,iconSquare:ef,iconCircle:ex,icon:ew,iconRounded:(0,s.eW)(async(t,e,{config:{themeVariables:a,flowchart:l}})=>{let{labelStyles:i}=u(e);e.labelStyle=i;let n=Math.max(e.assetHeight??48,e.assetWidth??48),h=l?.wrappingWidth;e.width=Math.max(n,h??0);let{shapeSvg:o,bbox:c,halfPadding:g,label:y}=await G(t,e,"icon-shape default"),f="t"===e.pos,w=n+2*g,b=n+2*g,{nodeBorder:k,mainBkg:$}=a,{stylesMap:M}=x(e),W=e.label?8:0,S=d.Z.svg(o),D=m(e,{stroke:M.get("fill")||$});"handDrawn"!==e.look&&(D.roughness=0,D.fillStyle="solid");let v=S.path(p(-b/2,-w/2,b,w,5),D),L=Math.max(b,c.width),C=w+c.height+W,P=S.rectangle(-L/2,-C/2,L,C,{...D,fill:"transparent",stroke:"none"}),A=o.insert(()=>v,":first-child"),Z=o.insert(()=>P);if(e.icon){let t=o.append("g");t.html(`<g>${await (0,r.s4)(e.icon,{height:n,width:n,fallbackPrefix:""})}</g>`);let a=t.node().getBBox(),l=a.width,i=a.height,s=a.x,h=a.y;t.attr("transform",`translate(${-l/2-s},${f?c.height/2+W/2-i/2-h:-c.height/2-W/2-i/2-h})`),t.selectAll("path").attr("fill",M.get("stroke")??k)}return y.attr("transform",`translate(${-c.width/2-(c.x-(c.left??0))},${f?-C/2:C/2-c.height})`),A.attr("transform",`translate(0,${f?c.height/2+W/2:-c.height/2-W/2})`),K(e,Z),e.intersect=function(t){if(s.cM.info("iconSquare intersect",e,t),!e.label)return td.rect(e,t);let a=e.x??0,r=e.y??0,l=e.height??0,i=[];return i=f?[{x:a-c.width/2,y:r-l/2},{x:a+c.width/2,y:r-l/2},{x:a+c.width/2,y:r-l/2+c.height+W},{x:a+b/2,y:r-l/2+c.height+W},{x:a+b/2,y:r+l/2},{x:a-b/2,y:r+l/2},{x:a-b/2,y:r-l/2+c.height+W},{x:a-c.width/2,y:r-l/2+c.height+W}]:[{x:a-b/2,y:r-l/2},{x:a+b/2,y:r-l/2},{x:a+b/2,y:r-l/2+w},{x:a+c.width/2,y:r-l/2+w},{x:a+c.width/2/2,y:r+l/2},{x:a-c.width/2,y:r+l/2},{x:a-c.width/2,y:r-l/2+w},{x:a-b/2,y:r-l/2+w}],td.polygon(e,i,t)},o},"iconRounded"),imageSquare:eu},eb=new Map,ek=(0,s.eW)(async(t,e,a)=>{let r,l;if("rect"===e.shape&&(e.rx&&e.ry?e.shape="roundedRect":e.shape="squareRect"),!em[e.shape])throw Error(`No such shape: ${e.shape}. Please check your syntax.`);if(e.link){let i;"sandbox"===a.config.securityLevel?i="_top":e.linkTarget&&(i=e.linkTarget||"_blank"),r=t.insert("svg:a").attr("xlink:href",e.link).attr("target",i),l=await em[e.shape](r,e,a)}else r=l=await em[e.shape](t,e,a);return e.tooltip&&l.attr("title",e.tooltip),eb.set(e.id,r),e.haveCallback&&eb.get(e.id).attr("class",eb.get(e.id).attr("class")+" clickable"),r},"insertNode"),e$=(0,s.eW)((t,e)=>{eb.set(e.id,t)},"setNodeElem"),eM=(0,s.eW)(()=>{eb.clear()},"clear"),eW=(0,s.eW)(t=>{let e=eb.get(t.id);s.cM.trace("Transforming node",t.diff,t,"translate("+(t.x-t.width/2-5)+", "+t.width/2+")");let a=t.diff||0;return t.clusterNode?e.attr("transform","translate("+(t.x+a-t.width/2)+", "+(t.y-t.height/2-8)+")"):e.attr("transform","translate("+t.x+", "+t.y+")"),a},"positionNode")}}]);